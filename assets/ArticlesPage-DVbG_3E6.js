import{r as V,c as k,d as L,u as I,a as l,b as t,m as $,t as u,g as x,e as h,F as T,h as D,i as o,y as E,f as q,k as H,w as K,z as Y,A as J,s as W,v as X,B as Z,q as F}from"./vue-vendor-DU-QEUjR.js";import{_ as S,u as G,a as R}from"./index-CDeJfRXt.js";import{u as ee}from"./useCategories-DfI6yKhP.js";import{g as O}from"./coverStyle-BhxAb7xK.js";import"./math-vendor-2lAd_3xY.js";import"./markdown-vendor-BDlm1NQN.js";const te=p=>{const c=V(""),f=(n,s)=>{if(!s.trim())return n;const r=new RegExp(`(${s})`,"gi");return n.replace(r,"<mark>$1</mark>")},v=k(()=>{const n=c.value.trim().toLowerCase();return n?p.filter(s=>[s.title,s.description,s.content,s.tag,s.categoryKey].join(" ").toLowerCase().includes(n)):p}),m=k(()=>{const n=c.value.trim();return n?v.value.map(s=>({...s,highlightedTitle:f(s.title,n),highlightedDescription:f(s.description,n)})):[]});return{searchQuery:c,searchResults:v,highlightedResults:m,clearSearch:()=>{c.value=""}}},se={class:"pagination"},ae={class:"pagination-controls"},ne={key:0,class:"total-items"},oe={key:1,class:"pagination-buttons"},le=["disabled"],ie={class:"page-numbers"},re=["disabled","onClick"],ce=["disabled"],ue={class:"items-per-page"},de=["value"],ge=["value"],pe=L({__name:"Pagination",props:{currentPage:{default:1},totalPages:{default:1},totalItems:{default:0},itemsPerPage:{default:5},itemsPerPageOptions:{default:()=>[5,10,20,50]}},emits:["update:currentPage","update:itemsPerPage","page-change"],setup(p,{emit:c}){const{t:f}=I(),v=p,m=c,b=k(()=>{const e=[],d=v.totalPages,g=v.currentPage;if(d<=7)for(let a=1;a<=d;a++)e.push(a);else if(g<=3){for(let a=1;a<=4;a++)e.push(a);e.push("..."),e.push(d)}else if(g>=d-2){e.push(1),e.push("...");for(let a=d-3;a<=d;a++)e.push(a)}else{e.push(1),e.push("...");for(let a=g-1;a<=g+1;a++)e.push(a);e.push("..."),e.push(d)}return e}),n=e=>{typeof e=="number"&&e>=1&&e<=v.totalPages&&(m("update:currentPage",e),m("page-change",e),window.scrollTo({top:0,behavior:"smooth"}))},s=()=>{if(v.currentPage>1){const e=v.currentPage-1;m("update:currentPage",e),m("page-change",e),window.scrollTo({top:0,behavior:"smooth"})}},r=()=>{if(v.currentPage<v.totalPages){const e=v.currentPage+1;m("update:currentPage",e),m("page-change",e),window.scrollTo({top:0,behavior:"smooth"})}},y=e=>{const d=e.target,g=parseInt(d.value,10);m("update:itemsPerPage",g),m("update:currentPage",1),m("page-change",1),window.scrollTo({top:0,behavior:"smooth"})};return(e,d)=>(o(),l("div",se,[t("div",ae,[p.totalItems>0?(o(),l("div",ne," å…± "+u(p.totalItems)+" æ¡ ",1)):$("",!0),p.totalPages>1?(o(),l("div",oe,[t("button",{class:x(["page-btn",{disabled:p.currentPage===1}]),disabled:p.currentPage===1,onClick:s},u(h(f)("pagination.prev")),11,le),t("div",ie,[(o(!0),l(T,null,D(b.value,g=>(o(),l("button",{key:g,class:x(["page-number",{active:g===p.currentPage,ellipsis:g==="..."}]),disabled:g==="...",onClick:a=>n(g)},u(g),11,re))),128))]),t("button",{class:x(["page-btn",{disabled:p.currentPage===p.totalPages}]),disabled:p.currentPage===p.totalPages,onClick:r},u(h(f)("pagination.next")),11,ce)])):$("",!0),t("div",ue,[t("select",{value:p.itemsPerPage,class:"items-per-page-select",onChange:y},[(o(!0),l(T,null,D(p.itemsPerPageOptions,g=>(o(),l("option",{key:g,value:g},u(g)+" / page ",9,ge))),128))],40,de)])])]))}}),he=S(pe,[["__scopeId","data-v-6c653ad1"]]),ve={class:"timeline-view"},me={class:"timeline-container"},_e={class:"timeline-year-node"},ye={class:"year-circle"},Pe={class:"timeline-articles"},be=["onClick","onKeyup"],fe={class:"timeline-content"},ke={key:0,class:"timeline-badge"},$e={class:"timeline-info"},we={class:"timeline-date"},Te={class:"updated-date"},Ce=["innerHTML"],De=["innerHTML"],Me={key:0,class:"empty-state"},Ve=L({__name:"TimelineView",props:{articles:{},sortDesc:{type:Boolean},currentPage:{},itemsPerPage:{}},setup(p){const c=p,{t:f}=I(),v=H(),m=s=>{v.push({name:"articleDetail",params:{id:s}})},b=k(()=>{const s={};return c.articles.forEach(y=>{const e=new Date(y.date).getFullYear().toString();s[e]||(s[e]=[]),s[e].push(y)}),Object.keys(s).sort((y,e)=>c.sortDesc?Number(e)-Number(y):Number(y)-Number(e)).map(y=>({year:y,articles:s[y]}))}),n=k(()=>{const s=b.value.flatMap(a=>(a.articles||[]).map(w=>({...w,year:a.year}))),r=(c.currentPage-1)*c.itemsPerPage,y=r+c.itemsPerPage,e=s.slice(r,y),d={};return e.forEach(a=>{const w=a.year;d[w]||(d[w]=[]),d[w].push(a)}),Object.keys(d).sort((a,w)=>c.sortDesc?Number(w)-Number(a):Number(a)-Number(w)).map(a=>({year:a,articles:d[a]||[]}))});return(s,r)=>(o(),l("div",ve,[t("div",me,[r[3]||(r[3]=t("div",{class:"timeline-line"},null,-1)),(o(!0),l(T,null,D(n.value,y=>(o(),l("div",{key:y.year,class:"timeline-year-group"},[t("div",_e,[t("div",ye,u(y.year),1)]),t("div",Pe,[(o(!0),l(T,null,D(y.articles,e=>(o(),l("article",{key:e.id,class:"timeline-article",role:"button",tabindex:"0",onClick:d=>m(e.id),onKeyup:E(d=>m(e.id),["enter"])},[r[2]||(r[2]=t("div",{class:"timeline-dot"},null,-1)),t("div",fe,[t("div",{class:"timeline-thumbnail",style:q(h(O)(e.cover))},[e.badge?(o(),l("span",ke,u(e.badge),1)):$("",!0)],4),t("div",$e,[t("div",we,[r[1]||(r[1]=t("span",{class:"date-icon"},"ðŸ“…",-1)),t("span",null,u(e.date),1),e.updatedDate&&e.updatedDate!==e.date?(o(),l(T,{key:0},[r[0]||(r[0]=t("span",{class:"date-separator"},"Â·",-1)),t("span",Te,u(h(f)("article.updated"))+": "+u(e.updatedDate),1)],64)):$("",!0)]),t("h3",{class:"timeline-title",innerHTML:e.highlightedTitle||e.title},null,8,Ce),e.description?(o(),l("p",{key:0,class:"timeline-description",innerHTML:e.highlightedDescription||e.description},null,8,De)):$("",!0)])])],40,be))),128))])]))),128))]),p.articles.length===0?(o(),l("div",Me,[t("p",null,u(h(f)("search.noResults")),1)])):$("",!0)]))}}),xe=S(Ve,[["__scopeId","data-v-7c65b752"]]),Ae={class:"articles"},Ne=["onClick","onKeyup"],Le={key:0,class:"badge"},Ie={class:"card-body"},Se={class:"tag-row"},Be={class:"tag"},Re=["innerHTML"],He=["innerHTML"],Ke={class:"meta"},Ye={key:0,class:"empty-state"},Fe=L({__name:"ArticleListView",props:{articles:{},empty:{type:Boolean,default:!1}},setup(p){const{t:c}=I(),f=H(),v=m=>{f.push({name:"articleDetail",params:{id:m}})};return(m,b)=>(o(),l("div",Ae,[(o(!0),l(T,null,D(p.articles,n=>(o(),l("article",{key:n.id,class:"article-card",role:"button",tabindex:"0",onClick:s=>v(n.id),onKeyup:E(s=>v(n.id),["enter"])},[t("div",{class:"card-cover",style:q(h(O)(n.cover))},[n.badge?(o(),l("span",Le,u(n.badge),1)):$("",!0)],4),t("div",Ie,[t("div",Se,[t("span",Be,u(n.tag),1)]),t("span",{class:"title",innerHTML:n.highlightedTitle||n.title},null,8,Re),t("p",{class:"description",innerHTML:n.highlightedDescription||n.description},null,8,He),t("div",Ke,[t("span",null,u(h(c)("article.created"))+": "+u(n.date),1),n.updatedDate?(o(),l(T,{key:0},[b[0]||(b[0]=t("span",{class:"dot"},"Â·",-1)),t("span",null,u(h(c)("article.updated"))+": "+u(n.updatedDate),1)],64)):$("",!0),b[1]||(b[1]=t("span",{class:"dot"},"Â·",-1)),t("span",null,u(n.platform),1)])])],40,Ne))),128)),p.empty?(o(),l("div",Ye,[t("p",null,u(h(c)("search.noResults")),1)])):$("",!0)]))}}),Ee=S(Fe,[["__scopeId","data-v-1f05ea88"]]),qe={class:"layout"},Oe={class:"content"},je={class:"sidebar"},ze={class:"filter-title"},Ue={class:"category-list"},Qe=["onClick"],Je={class:"category-label"},We={class:"category-count"},Xe={class:"article-area"},Ze={class:"search-section"},Ge={class:"search-box"},et=["placeholder"],tt={class:"list-header"},st={class:"article-count"},at={key:0,class:"search-hint"},nt={class:"header-actions"},ot=["title"],lt={key:0},it={key:1},rt=L({__name:"ArticlesPage",setup(p){const{t:c}=I(),f=H(),v=G(),{categories:m}=ee(!0),b=V("all"),n=k(()=>{const P={};return P.all=R.length,m.value.forEach(i=>{i.key!=="all"&&(P[i.key]=R.filter(_=>_.categoryKey===i.key).length)}),P}),s=V(!0),{searchQuery:r,searchResults:y,highlightedResults:e}=te(R),d=V(5),g=V(1),a=k({get:()=>v.articleViewMode,set:P=>{if(P==="list"||P==="timeline"){v.articleViewMode=P;try{localStorage.setItem("articleViewMode",P)}catch(i){console.warn("Failed to save view mode to localStorage:",i)}}}}),w=()=>{f.push({name:"articleNew"})},B=k(()=>{let P=y.value;return b.value!=="all"&&(P=P.filter(i=>i.categoryKey===b.value)),P.slice().sort((i,_)=>{const C=new Date(i.date).getTime(),N=new Date(_.date).getTime();return s.value?N-C:C-N})}),A=k(()=>{const P=r.value.trim();let i=B.value;return P&&(i=i.map(_=>{const C=e.value.find(N=>N.id===_.id);return C?{..._,highlightedTitle:C.highlightedTitle,highlightedDescription:C.highlightedDescription}:_})),i}),j=k(()=>{const P=(g.value-1)*d.value,i=P+d.value;return A.value.slice(P,i)}),z=k(()=>Math.ceil(A.value.length/d.value)),M=()=>{g.value=1};K([r,b,s],()=>{M()});const U=()=>{s.value=!s.value,M()},Q=()=>{v.toggleArticleViewMode(),M()};return K(()=>v.articleViewMode,()=>{M()}),(P,i)=>(o(),l("main",qe,[t("section",Oe,[t("aside",je,[t("div",ze,[i[4]||(i[4]=t("span",{class:"filter-icon"},"âŒ˜",-1)),t("span",null,u(h(c)("filter.category")),1)]),t("div",Ue,[(o(!0),l(T,null,D(h(m),_=>(o(),l("button",{key:_.key,class:x(["category-item",{active:b.value===_.key}]),type:"button",onClick:C=>{b.value=_.key,M()}},[t("span",Je,u(_.label),1),t("span",We,"("+u(n.value[_.key]||0)+")",1)],10,Qe))),128))])]),t("section",Xe,[t("div",Ze,[t("div",Ge,[i[5]||(i[5]=t("span",{class:"search-icon"},"ðŸ”",-1)),W(t("input",{"onUpdate:modelValue":i[0]||(i[0]=_=>Z(r)?r.value=_:null),type:"text",class:"search-input",placeholder:h(c)("search.placeholder")},null,8,et),[[X,h(r)]]),h(r)?(o(),l("button",{key:0,class:"clear-btn",type:"button",onClick:i[1]||(i[1]=_=>r.value="")}," Ã— ")):$("",!0)])]),t("div",tt,[t("div",st,[F(u(h(c)("articles.count",{count:B.value.length}))+" ",1),h(r)?(o(),l("span",at,u(h(c)("search.results",{query:h(r)})),1)):$("",!0)]),t("div",nt,[t("button",{class:"view-toggle-btn",type:"button",onClick:Q,title:a.value==="list"?h(c)("actions.timelineView"):h(c)("actions.listView")},[a.value==="list"?(o(),l("span",lt,"ðŸ“…")):(o(),l("span",it,"ðŸ“‹"))],8,ot),t("button",{class:"new-article-btn",type:"button",onClick:w}," + "+u(h(c)("article.new")),1),t("button",{class:"sort-btn",type:"button",onClick:U},[F(u(h(c)("actions.sortByTime"))+" ",1),t("span",{class:x(["arrow",{rotated:!s.value}])},"âŒ„",2)])])]),a.value==="list"?(o(),Y(Ee,{key:0,articles:j.value,empty:B.value.length===0},null,8,["articles","empty"])):(o(),Y(xe,{key:1,articles:A.value,"sort-desc":s.value,"current-page":g.value,"items-per-page":d.value},null,8,["articles","sort-desc","current-page","items-per-page"])),J(he,{"current-page":g.value,"onUpdate:currentPage":i[2]||(i[2]=_=>g.value=_),"items-per-page":d.value,"onUpdate:itemsPerPage":i[3]||(i[3]=_=>d.value=_),"total-pages":z.value,"total-items":A.value.length,"items-per-page-options":[5,10,20,50]},null,8,["current-page","items-per-page","total-pages","total-items"])])])]))}}),vt=S(rt,[["__scopeId","data-v-7d49d80a"]]);export{vt as default};
