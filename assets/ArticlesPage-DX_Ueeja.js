import{r as D,c as w,d as A,u as I,a as l,b as t,m as k,t as c,g as x,e as p,F as T,h as M,i as o,y as E,f as q,k as H,w as K,z as F,A as J,s as W,v as X,B as Z,q as Y}from"./vue-vendor-DU-QEUjR.js";import{_ as L,a as R}from"./index-D73fm2qe.js";import{u as G}from"./useCategories-DfI6yKhP.js";import{g as O}from"./coverStyle-BhxAb7xK.js";import"./math-vendor-Tecg6Gpz.js";import"./markdown-vendor-BDlm1NQN.js";const ee=d=>{const r=D(""),b=(a,s)=>{if(!s.trim())return a;const _=new RegExp(`(${s})`,"gi");return a.replace(_,"<mark>$1</mark>")},m=w(()=>{const a=r.value.trim().toLowerCase();return a?d.filter(s=>[s.title,s.description,s.content,s.tag,s.categoryKey].join(" ").toLowerCase().includes(a)):d}),g=w(()=>{const a=r.value.trim();return a?m.value.map(s=>({...s,highlightedTitle:b(s.title,a),highlightedDescription:b(s.description,a)})):[]});return{searchQuery:r,searchResults:m,highlightedResults:g,clearSearch:()=>{r.value=""}}},te={class:"pagination"},se={class:"pagination-controls"},ae={key:0,class:"total-items"},ne={key:1,class:"pagination-buttons"},oe=["disabled"],le={class:"page-numbers"},ie=["disabled","onClick"],re=["disabled"],ce={class:"items-per-page"},ue=["value"],de=["value"],ge=A({__name:"Pagination",props:{currentPage:{default:1},totalPages:{default:1},totalItems:{default:0},itemsPerPage:{default:5},itemsPerPageOptions:{default:()=>[5,10,20,50]}},emits:["update:currentPage","update:itemsPerPage","page-change"],setup(d,{emit:r}){const{t:b}=I(),m=d,g=r,f=w(()=>{const e=[],u=m.totalPages,y=m.currentPage;if(u<=7)for(let n=1;n<=u;n++)e.push(n);else if(y<=3){for(let n=1;n<=4;n++)e.push(n);e.push("..."),e.push(u)}else if(y>=u-2){e.push(1),e.push("...");for(let n=u-3;n<=u;n++)e.push(n)}else{e.push(1),e.push("...");for(let n=y-1;n<=y+1;n++)e.push(n);e.push("..."),e.push(u)}return e}),a=e=>{typeof e=="number"&&e>=1&&e<=m.totalPages&&(g("update:currentPage",e),g("page-change",e),window.scrollTo({top:0,behavior:"smooth"}))},s=()=>{if(m.currentPage>1){const e=m.currentPage-1;g("update:currentPage",e),g("page-change",e),window.scrollTo({top:0,behavior:"smooth"})}},_=()=>{if(m.currentPage<m.totalPages){const e=m.currentPage+1;g("update:currentPage",e),g("page-change",e),window.scrollTo({top:0,behavior:"smooth"})}},P=e=>{const u=e.target,y=parseInt(u.value,10);g("update:itemsPerPage",y),g("update:currentPage",1),g("page-change",1),window.scrollTo({top:0,behavior:"smooth"})};return(e,u)=>(o(),l("div",te,[t("div",se,[d.totalItems>0?(o(),l("div",ae," å…± "+c(d.totalItems)+" æ¡ ",1)):k("",!0),d.totalPages>1?(o(),l("div",ne,[t("button",{class:x(["page-btn",{disabled:d.currentPage===1}]),disabled:d.currentPage===1,onClick:s},c(p(b)("pagination.prev")),11,oe),t("div",le,[(o(!0),l(T,null,M(f.value,y=>(o(),l("button",{key:y,class:x(["page-number",{active:y===d.currentPage,ellipsis:y==="..."}]),disabled:y==="...",onClick:n=>a(y)},c(y),11,ie))),128))]),t("button",{class:x(["page-btn",{disabled:d.currentPage===d.totalPages}]),disabled:d.currentPage===d.totalPages,onClick:_},c(p(b)("pagination.next")),11,re)])):k("",!0),t("div",ce,[t("select",{value:d.itemsPerPage,class:"items-per-page-select",onChange:P},[(o(!0),l(T,null,M(d.itemsPerPageOptions,y=>(o(),l("option",{key:y,value:y},c(y)+" / page ",9,de))),128))],40,ue)])])]))}}),pe=L(ge,[["__scopeId","data-v-6c653ad1"]]),he={class:"timeline-view"},ve={class:"timeline-container"},me={class:"timeline-year-node"},_e={class:"year-circle"},ye={class:"timeline-articles"},Pe=["onClick","onKeyup"],be={class:"timeline-content"},fe={key:0,class:"timeline-badge"},ke={class:"timeline-info"},$e={class:"timeline-date"},we={class:"updated-date"},Te=["innerHTML"],Ce=["innerHTML"],De={key:0,class:"empty-state"},Me=A({__name:"TimelineView",props:{articles:{},sortDesc:{type:Boolean},currentPage:{},itemsPerPage:{}},setup(d){const r=d,{t:b}=I(),m=H(),g=s=>{m.push({name:"articleDetail",params:{id:s}})},f=w(()=>{const s={};return r.articles.forEach(P=>{const e=new Date(P.date).getFullYear().toString();s[e]||(s[e]=[]),s[e].push(P)}),Object.keys(s).sort((P,e)=>r.sortDesc?Number(e)-Number(P):Number(P)-Number(e)).map(P=>({year:P,articles:s[P]}))}),a=w(()=>{const s=f.value.flatMap(n=>(n.articles||[]).map($=>({...$,year:n.year}))),_=(r.currentPage-1)*r.itemsPerPage,P=_+r.itemsPerPage,e=s.slice(_,P),u={};return e.forEach(n=>{const $=n.year;u[$]||(u[$]=[]),u[$].push(n)}),Object.keys(u).sort((n,$)=>r.sortDesc?Number($)-Number(n):Number(n)-Number($)).map(n=>({year:n,articles:u[n]||[]}))});return(s,_)=>(o(),l("div",he,[t("div",ve,[_[3]||(_[3]=t("div",{class:"timeline-line"},null,-1)),(o(!0),l(T,null,M(a.value,P=>(o(),l("div",{key:P.year,class:"timeline-year-group"},[t("div",me,[t("div",_e,c(P.year),1)]),t("div",ye,[(o(!0),l(T,null,M(P.articles,e=>(o(),l("article",{key:e.id,class:"timeline-article",role:"button",tabindex:"0",onClick:u=>g(e.id),onKeyup:E(u=>g(e.id),["enter"])},[_[2]||(_[2]=t("div",{class:"timeline-dot"},null,-1)),t("div",be,[t("div",{class:"timeline-thumbnail",style:q(p(O)(e.cover))},[e.badge?(o(),l("span",fe,c(e.badge),1)):k("",!0)],4),t("div",ke,[t("div",$e,[_[1]||(_[1]=t("span",{class:"date-icon"},"ðŸ“…",-1)),t("span",null,c(e.date),1),e.updatedDate&&e.updatedDate!==e.date?(o(),l(T,{key:0},[_[0]||(_[0]=t("span",{class:"date-separator"},"Â·",-1)),t("span",we,c(p(b)("article.updated"))+": "+c(e.updatedDate),1)],64)):k("",!0)]),t("h3",{class:"timeline-title",innerHTML:e.highlightedTitle||e.title},null,8,Te),e.description?(o(),l("p",{key:0,class:"timeline-description",innerHTML:e.highlightedDescription||e.description},null,8,Ce)):k("",!0)])])],40,Pe))),128))])]))),128))]),d.articles.length===0?(o(),l("div",De,[t("p",null,c(p(b)("search.noResults")),1)])):k("",!0)]))}}),xe=L(Me,[["__scopeId","data-v-7c65b752"]]),Ve={class:"articles"},Ne=["onClick","onKeyup"],Se={key:0,class:"badge"},Ae={class:"card-body"},Ie={class:"tag-row"},Le={class:"tag"},Be=["innerHTML"],Re=["innerHTML"],He={class:"meta"},Ke={key:0,class:"empty-state"},Fe=A({__name:"ArticleListView",props:{articles:{},empty:{type:Boolean,default:!1}},setup(d){const{t:r}=I(),b=H(),m=g=>{b.push({name:"articleDetail",params:{id:g}})};return(g,f)=>(o(),l("div",Ve,[(o(!0),l(T,null,M(d.articles,a=>(o(),l("article",{key:a.id,class:"article-card",role:"button",tabindex:"0",onClick:s=>m(a.id),onKeyup:E(s=>m(a.id),["enter"])},[t("div",{class:"card-cover",style:q(p(O)(a.cover))},[a.badge?(o(),l("span",Se,c(a.badge),1)):k("",!0)],4),t("div",Ae,[t("div",Ie,[t("span",Le,c(a.tag),1)]),t("span",{class:"title",innerHTML:a.highlightedTitle||a.title},null,8,Be),t("p",{class:"description",innerHTML:a.highlightedDescription||a.description},null,8,Re),t("div",He,[t("span",null,c(p(r)("article.created"))+": "+c(a.date),1),a.updatedDate?(o(),l(T,{key:0},[f[0]||(f[0]=t("span",{class:"dot"},"Â·",-1)),t("span",null,c(p(r)("article.updated"))+": "+c(a.updatedDate),1)],64)):k("",!0),f[1]||(f[1]=t("span",{class:"dot"},"Â·",-1)),t("span",null,c(a.platform),1)])])],40,Ne))),128)),d.empty?(o(),l("div",Ke,[t("p",null,c(p(r)("search.noResults")),1)])):k("",!0)]))}}),Ye=L(Fe,[["__scopeId","data-v-1f05ea88"]]),Ee={class:"layout"},qe={class:"content"},Oe={class:"sidebar"},je={class:"filter-title"},ze={class:"category-list"},Ue=["onClick"],Qe={class:"category-label"},Je={class:"category-count"},We={class:"article-area"},Xe={class:"search-section"},Ze={class:"search-box"},Ge=["placeholder"],et={class:"list-header"},tt={class:"article-count"},st={key:0,class:"search-hint"},at={class:"header-actions"},nt=["title"],ot={key:0},lt={key:1},it=A({__name:"ArticlesPage",setup(d){const{t:r}=I(),b=H(),{categories:m}=G(!0),g=D("all"),f=w(()=>{const h={};return h.all=R.length,m.value.forEach(i=>{i.key!=="all"&&(h[i.key]=R.filter(v=>v.categoryKey===i.key).length)}),h}),a=D(!0),{searchQuery:s,searchResults:_,highlightedResults:P}=ee(R),e=D(5),u=D(1),n=D((()=>{try{const h=localStorage.getItem("articleViewMode");if(h==="list"||h==="timeline")return h}catch(h){console.warn("Failed to read view mode from localStorage:",h)}return"list"})()),$=()=>{b.push({name:"articleNew"})},B=w(()=>{let h=_.value;return g.value!=="all"&&(h=h.filter(i=>i.categoryKey===g.value)),h.slice().sort((i,v)=>{const C=new Date(i.date).getTime(),S=new Date(v.date).getTime();return a.value?S-C:C-S})}),V=w(()=>{const h=s.value.trim();let i=B.value;return h&&(i=i.map(v=>{const C=P.value.find(S=>S.id===v.id);return C?{...v,highlightedTitle:C.highlightedTitle,highlightedDescription:C.highlightedDescription}:v})),i}),j=w(()=>{const h=(u.value-1)*e.value,i=h+e.value;return V.value.slice(h,i)}),z=w(()=>Math.ceil(V.value.length/e.value)),N=()=>{u.value=1};K([s,g,a],()=>{N()});const U=()=>{a.value=!a.value,N()},Q=()=>{n.value=n.value==="list"?"timeline":"list",N()};return K(n,h=>{try{localStorage.setItem("articleViewMode",h)}catch(i){console.warn("Failed to save view mode to localStorage:",i)}}),(h,i)=>(o(),l("main",Ee,[t("section",qe,[t("aside",Oe,[t("div",je,[i[4]||(i[4]=t("span",{class:"filter-icon"},"âŒ˜",-1)),t("span",null,c(p(r)("filter.category")),1)]),t("div",ze,[(o(!0),l(T,null,M(p(m),v=>(o(),l("button",{key:v.key,class:x(["category-item",{active:g.value===v.key}]),type:"button",onClick:C=>{g.value=v.key,N()}},[t("span",Qe,c(v.label),1),t("span",Je,"("+c(f.value[v.key]||0)+")",1)],10,Ue))),128))])]),t("section",We,[t("div",Xe,[t("div",Ze,[i[5]||(i[5]=t("span",{class:"search-icon"},"ðŸ”",-1)),W(t("input",{"onUpdate:modelValue":i[0]||(i[0]=v=>Z(s)?s.value=v:null),type:"text",class:"search-input",placeholder:p(r)("search.placeholder")},null,8,Ge),[[X,p(s)]]),p(s)?(o(),l("button",{key:0,class:"clear-btn",type:"button",onClick:i[1]||(i[1]=v=>s.value="")}," Ã— ")):k("",!0)])]),t("div",et,[t("div",tt,[Y(c(p(r)("articles.count",{count:B.value.length}))+" ",1),p(s)?(o(),l("span",st,c(p(r)("search.results",{query:p(s)})),1)):k("",!0)]),t("div",at,[t("button",{class:"view-toggle-btn",type:"button",onClick:Q,title:n.value==="list"?p(r)("actions.timelineView"):p(r)("actions.listView")},[n.value==="list"?(o(),l("span",ot,"ðŸ“…")):(o(),l("span",lt,"ðŸ“‹"))],8,nt),t("button",{class:"new-article-btn",type:"button",onClick:$}," + "+c(p(r)("article.new")),1),t("button",{class:"sort-btn",type:"button",onClick:U},[Y(c(p(r)("actions.sortByTime"))+" ",1),t("span",{class:x(["arrow",{rotated:!a.value}])},"âŒ„",2)])])]),n.value==="list"?(o(),F(Ye,{key:0,articles:j.value,empty:B.value.length===0},null,8,["articles","empty"])):(o(),F(xe,{key:1,articles:V.value,"sort-desc":a.value,"current-page":u.value,"items-per-page":e.value},null,8,["articles","sort-desc","current-page","items-per-page"])),J(pe,{"current-page":u.value,"onUpdate:currentPage":i[2]||(i[2]=v=>u.value=v),"items-per-page":e.value,"onUpdate:itemsPerPage":i[3]||(i[3]=v=>e.value=v),"total-pages":z.value,"total-items":V.value.length,"items-per-page-options":[5,10,20,50]},null,8,["current-page","items-per-page","total-pages","total-items"])])])]))}}),ht=L(it,[["__scopeId","data-v-d1d0ea34"]]);export{ht as default};
