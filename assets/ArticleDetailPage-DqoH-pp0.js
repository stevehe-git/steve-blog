import{c as T,r as j,d as E,u as $,a as _,b as a,j as D,t as p,e as y,i as b,n as F,o as G,w as P,f as J,F as K,h as U,x as Q,z as X,p as H,l as N,v as O,y as Z,k as M,q as R}from"./vue-vendor-D3XWct0c.js";import{u as ee,g as te,a as A}from"./index-CQMkb9nN.js";import{r as oe,g as q,a as re,M as ne,i as ae}from"./markdown-vendor-BDlm1NQN.js";import{H as V}from"./highlight-vendor-2JJYcUgK.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b8 as z,b9 as se}from"./math-vendor-BeDL-_gi.js";import{g as ce}from"./coverStyle-BhxAb7xK.js";var le=oe();const ie=q(le),S=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var de=re();const ue=q(de),me=t=>t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"),L=new ne({html:!0,linkify:!0,typographer:!0,breaks:!0,highlight:function(t,o){if(o==="flowchart"||o==="flow")return'<div class="flowchart-container"><pre class="flowchart" id="'+("flowchart-"+Math.random().toString(36).substr(2,9))+'">'+S(t)+"</pre></div>";if(o==="mermaid"||o==="sequenceDiagram"||o==="classDiagram"||o==="stateDiagram"||o==="erDiagram"||o==="journey"||o==="gantt"||o==="pie"||o==="requirement"||o==="gitgraph"||o==="mindmap"||o==="timeline")return'<div class="mermaid-container"><pre class="mermaid" id="'+("mermaid-"+Math.random().toString(36).substr(2,9))+'">'+S(t)+"</pre></div>";if(o&&V.getLanguage(o))try{return'<pre class="hljs"><code class="language-'+S(o)+'">'+V.highlight(t,{language:o}).value+"</code></pre>"}catch{}return'<pre class="hljs"><code>'+S(t)+"</code></pre>"}});L.use(ae);L.use(ie);L.use(ue,{enabled:!0,label:!0,labelAfter:!0});const W=t=>{if(!t||!Array.isArray(t))return"";let o="";for(const n of t)n?.type==="text"&&n.content||n?.type==="code_inline"&&n.content?o+=n.content:n?.children&&(o+=W(n.children));return o};L.use(function(t){const o=t.renderer.rules.heading_open||function(n,u,f,s,l){return l.renderToken(n,u,f)};t.renderer.rules.heading_open=function(n,u,f,s,l){const m=n[u];if(!m)return o(n,u,f,s,l);const g=parseInt(m.tag.slice(1));let r="",e=u+1;for(;e<n.length&&n[e]?.type!=="heading_close";){const h=n[e];if(h?.type==="inline"){h.children?r=W(h.children):r=h.content||"";break}e++}const c=me(r),d=s.headingCount||{},i=d[c]||0;d[c]=i+1;const v=i?`${c}-${i}`:c;return s.toc||(s.toc=[]),s.toc.push({id:v,text:r,level:g}),m.attrSet("id",v),o(n,u,f,s,l)}});const he=t=>{const o={toc:[],headingCount:{}};return{html:L.render(t,o),toc:o.toc||[]}},pe=t=>T(()=>he(t.value||"")),fe=(t="article-comments")=>{const o=j({}),n=()=>{try{const l=localStorage.getItem(t);o.value=l?JSON.parse(l):{}}catch{o.value={}}},u=()=>{localStorage.setItem(t,JSON.stringify(o.value))};return{commentsMap:o,loadComments:n,getComments:l=>o.value[l]??[],addComment:(l,m)=>{const g=m.content.trim();if(!g)return;const r=m.author?.trim()||"匿名",e=o.value[l]??[],c={id:Date.now(),author:r,content:g,createdAt:new Date().toISOString()};return o.value={...o.value,[l]:[...e,c]},u(),c}}},ve={class:"hero detail-hero"},ge={class:"header-actions"},Ce={key:0,class:"title-area"},ye={key:0,class:"badge"},_e={class:"meta"},be={key:1,class:"title-area"},ke={class:"meta"},we=E({__name:"ArticleHeader",props:{article:{}},emits:["goBack","edit"],setup(t,{emit:o}){const n=o,{t:u}=$();return(f,s)=>(b(),_("section",ve,[a("div",ge,[a("button",{class:"back-btn",type:"button",onClick:s[0]||(s[0]=l=>n("goBack"))},"← "+p(y(u)("article.back")),1),t.article?(b(),_("button",{key:0,class:"edit-btn",type:"button",onClick:s[1]||(s[1]=l=>n("edit"))},"✎ "+p(y(u)("article.edit")),1)):D("",!0)]),t.article?(b(),_("div",Ce,[t.article.badge?(b(),_("span",ye,p(t.article.badge),1)):D("",!0),a("h1",null,p(t.article.title),1),a("p",_e,[a("span",null,p(t.article.date),1),s[2]||(s[2]=a("span",{class:"dot"},"·",-1)),a("span",null,p(t.article.platform),1),s[3]||(s[3]=a("span",{class:"dot"},"·",-1)),a("span",null,p(t.article.tag),1)])])):(b(),_("div",be,[a("h1",null,p(y(u)("article.notFound")),1),a("p",ke,p(y(u)("article.notFoundDesc")),1)]))]))}}),xe=B(we,[["__scopeId","data-v-0f3ff6f9"]]),Te=(t,o)=>{const u=o||(r=>({copy:"复制",copied:"已复制!",copyFailed:"复制失败",copyCode:"复制代码"})[r]||r),f=r=>{const e=r.textContent;r.textContent=u("copied"),r.classList.add("copied"),setTimeout(()=>{r.textContent=e,r.classList.remove("copied")},2e3)},s=r=>{const e=r.textContent;r.textContent=u("copyFailed"),r.classList.add("error"),setTimeout(()=>{r.textContent=e,r.classList.remove("error")},2e3)},l=async(r,e)=>{if(!navigator.clipboard||!navigator.clipboard.writeText){console.error("Clipboard API 不可用"),s(e);return}try{await navigator.clipboard.writeText(r),f(e)}catch(c){console.error("复制失败:",c),s(e)}},m=r=>{const e=document.createElement("button");return e.className="copy-code-btn",e.textContent=u("copy"),e.type="button",e.setAttribute("aria-label",u("copyCode")),e.addEventListener("click",()=>{l(r,e)}),e};return{addCopyButtons:()=>{F(()=>{if(!t.value)return;t.value.querySelectorAll("pre.hljs").forEach(e=>{if(e.querySelector(".copy-code-btn"))return;const c=e.querySelector("code");if(!c)return;const d=c.textContent||c.innerText||"",i=m(d);e.appendChild(i)})})}}},Se=t=>{let o=!1,n="default";const u=()=>document.documentElement.classList.contains("dark")?"dark":"default",f=(e=!1)=>{const c=u();(e||!o||n!==c)&&(z.initialize({startOnLoad:!1,theme:c,securityLevel:"loose",themeVariables:c==="dark"?{primaryColor:"#2a2a2a",primaryTextColor:"#e0e0e0",primaryBorderColor:"#e0e0e0",lineColor:"#e0e0e0",secondaryColor:"#1a1a1a",tertiaryColor:"#333",background:"#1e1e1e",mainBkg:"#2a2a2a",secondBkg:"#1a1a1a",textColor:"#e0e0e0",border1:"#e0e0e0",border2:"#9ca3af",noteBkgColor:"#2a2a2a",noteTextColor:"#e0e0e0",noteBorderColor:"#e0e0e0",actorBorder:"#e0e0e0",actorBkg:"#2a2a2a",actorTextColor:"#e0e0e0",actorLineColor:"#e0e0e0",labelBoxBkgColor:"#2a2a2a",labelBoxBorderColor:"#e0e0e0",labelTextColor:"#e0e0e0",loopTextColor:"#e0e0e0",activationBorderColor:"#e0e0e0",activationBkgColor:"#1a1a1a",sequenceNumberColor:"#e0e0e0",sectionBkgColor:"#2a2a2a",altBkgColor:"#1a1a1a",clusterBkg:"#2a2a2a",clusterBorder:"#e0e0e0",defaultLinkColor:"#e0e0e0",titleColor:"#e0e0e0",edgeLabelBackground:"#2a2a2a",compositeBackground:"#2a2a2a",compositeTitleBackground:"#1a1a1a",compositeBorder:"#e0e0e0",stateLabelColor:"#e0e0e0",stateBkg:"#2a2a2a",labelBorderColor:"#e0e0e0",errorBkgColor:"#4a1a1a",errorTextColor:"#ff6b6b"}:void 0}),o=!0,n=c)},s=new WeakMap,l=(e,c=!1)=>{const d=e.id||"mermaid-"+Math.random().toString(36).substr(2,9),i=e.parentElement?.classList.contains("mermaid-container")?e.parentElement:null;let v="";if(v=e.textContent||"",!v.trim()&&c&&i&&s.has(i)&&(v=s.get(i)||""),v.trim()&&i&&!s.has(i)&&s.set(i,v),!v.trim()||e.classList.contains("mermaid-rendered")&&!c)return;e.classList.add("mermaid-rendered");const h=d+"-svg";z.render(h,v).then(C=>{const w=e.parentElement;w&&w.classList.contains("mermaid-container")?w.innerHTML=C.svg:e.innerHTML=C.svg}).catch(C=>{console.error("Mermaid 渲染失败:",C),m(e,v)})},m=(e,c)=>{const d=e.parentElement;d&&d.classList.contains("mermaid-container")&&(d.innerHTML='<pre class="mermaid-error">'+S(c)+"</pre>")},g=(e=!1)=>{F(()=>{if(!t.value)return;const c=u();e||n!==c?f(!0):f();const d=".mermaid-container",i=t.value.querySelectorAll(d);e&&i.forEach(h=>{if(h.querySelector("svg")&&s.has(h)){const w=s.get(h)||"",x="mermaid-"+Math.random().toString(36).substr(2,9);w&&(h.innerHTML=`<pre class="mermaid" id="${x}">${w}</pre>`)}}),setTimeout(()=>{if(!t.value)return;t.value.querySelectorAll(d).forEach(x=>{const k=x.querySelector("pre.mermaid");k&&l(k,e)});const C=e?"pre.mermaid":"pre.mermaid:not(.mermaid-rendered)";t.value.querySelectorAll(C).forEach(x=>{x.closest(".mermaid-container")||l(x,e)})},e?50:0)})};return{initMermaid:g,rerenderMermaid:()=>{g(!0)}}};var Ee=se();const $e=q(Ee),Be=t=>{const o=new WeakMap,n=()=>{const r=document.documentElement.classList.contains("dark");return{textColor:r?"#e0e0e0":"#000000",lineColor:r?"#e0e0e0":"#000000",fillColor:r?"#2a2a2a":"#ffffff",isDark:r}},u=()=>{const{textColor:r,lineColor:e,fillColor:c,isDark:d}=n();return{"line-width":2,"line-length":50,"text-margin":10,"font-size":14,"font-color":r,"line-color":e,"element-color":r,fill:c,"yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,flowstate:{past:{fill:d?"#444444":"#CCCCCC","font-size":12},current:{fill:d?"#4a4a00":"yellow","font-color":d?"#ff6b6b":"red","font-weight":"bold"},future:{fill:d?"#666600":"#FFFF99"},request:{fill:d?"#003366":"blue"},invalid:{fill:d?"#222222":"#444444"},approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}}},f=r=>{const e=document.createElement("div");return e.className="flowchart-svg-container",e.id=r+"-svg",e},s=(r,e=!1)=>{const c=r.id||"flowchart-"+Math.random().toString(36).substr(2,9),d=r.parentElement?.classList.contains("flowchart-container")?r.parentElement:null;let i="";if(i=r.textContent||"",!i.trim()&&e&&d&&o.has(d)&&(i=o.get(d)||""),i.trim()&&d&&!o.has(d)&&o.set(d,i),!!i.trim()&&!(r.classList.contains("flowchart-rendered")&&!e)){r.classList.add("flowchart-rendered");try{const v=$e.parse(i),h=f(c),C=r.parentElement;if(C&&C.classList.contains("flowchart-container")){C.innerHTML="",C.appendChild(h);const w=u();v.drawSVG(c+"-svg",w)}}catch(v){console.error("Flowchart 渲染失败:",v),l(r,i)}}},l=(r,e)=>{const c=r.parentElement;c&&c.classList.contains("flowchart-container")&&(c.innerHTML='<pre class="flowchart-error">'+S(e)+"</pre>")},m=(r=!1)=>{F(()=>{if(!t.value)return;const c=t.value.querySelectorAll(".flowchart-container");r&&c.forEach(i=>{if(i.querySelector(".flowchart-svg-container")&&o.has(i)){const h=o.get(i)||"",C="flowchart-"+Math.random().toString(36).substr(2,9);h&&(i.innerHTML=`<pre class="flowchart" id="${C}">${h}</pre>`)}}),setTimeout(()=>{if(!t.value)return;t.value.querySelectorAll(".flowchart-container").forEach(h=>{const C=h.querySelector("pre.flowchart");C&&s(C,r)})},r?50:0)})};return{initFlowchart:m,rerenderFlowchart:()=>{m(!0)}}},Le={class:"article-card detail-card"},Me={key:0,class:"badge"},Ae={class:"card-body"},De={class:"tag-row"},Fe={class:"tag"},Ie={class:"title"},qe={class:"description"},Pe={class:"meta"},He={class:"nav-row"},Ne=["disabled"],Oe=["disabled"],Ve=["innerHTML"],ze=E({__name:"ArticleContent",props:{article:{},htmlContent:{},prevArticle:{},nextArticle:{}},emits:["goPrev","goNext"],setup(t,{emit:o}){const{t:n}=$(),u=ee(),f=t,s=o,l=j(),{addCopyButtons:m}=Te(l,v=>({copy:n("code.copy"),copied:n("code.copied"),copyFailed:n("code.copyFailed"),copyCode:n("code.copyCode")})[v]||v),{initMermaid:g,rerenderMermaid:r}=Se(l),{initFlowchart:e,rerenderFlowchart:c}=Be(l),d=()=>{m(),g(),e(),i()},i=()=>{F(()=>{if(!l.value)return;const v=l.value.querySelectorAll("table"),h=u.isDark||document.documentElement.classList.contains("dark"),w=getComputedStyle(document.documentElement).getPropertyValue("--border").trim()||"#e5e7eb",k=h?"#d1d5db":w;v.forEach(I=>{I.style.setProperty("border",`2px solid ${k}`,"important"),I.querySelectorAll("th, td").forEach(Y=>{Y.style.setProperty("border",`1px solid ${k}`,"important")})})})};return G(()=>{d(),new MutationObserver(()=>{i(),setTimeout(()=>{r(),c()},100)}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),setTimeout(()=>{i()},100)}),P(()=>f.htmlContent,()=>{d(),setTimeout(()=>{i()},100)}),P(()=>u.isDark,()=>{setTimeout(()=>{i(),r(),c()},100)}),(v,h)=>(b(),_("article",Le,[a("div",{class:"card-cover",style:J(y(ce)(t.article.cover))},[t.article.badge?(b(),_("span",Me,p(t.article.badge),1)):D("",!0)],4),a("div",Ae,[a("div",De,[a("span",Fe,p(t.article.tag),1)]),a("h2",Ie,p(t.article.title),1),a("p",qe,p(t.article.description),1),a("div",Pe,[a("span",null,p(t.article.date),1),h[2]||(h[2]=a("span",{class:"dot"},"·",-1)),a("span",null,p(t.article.platform),1),h[3]||(h[3]=a("span",{class:"dot"},"·",-1)),a("span",null,p(t.article.tag),1)]),a("div",He,[a("button",{class:"ghost-btn",type:"button",disabled:!t.prevArticle,onClick:h[0]||(h[0]=C=>s("goPrev"))}," ← "+p(y(n)("article.prevArticle")),9,Ne),a("button",{class:"ghost-btn",type:"button",disabled:!t.nextArticle,onClick:h[1]||(h[1]=C=>s("goNext"))},p(y(n)("article.nextArticle"))+" → ",9,Oe)]),a("div",{ref_key:"contentBlockRef",ref:l,class:"content-block",innerHTML:t.htmlContent},null,8,Ve)])]))}}),je=B(ze,[["__scopeId","data-v-eea23efe"]]),Ge={key:0,class:"toc"},Je={class:"toc-title"},Ke=["href","onClick"],Ue=E({__name:"ArticleTOC",props:{toc:{}},setup(t){const{t:o}=$(),n=(u,f)=>{u.preventDefault();const s=document.getElementById(f);if(s){const g=s.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:g,behavior:"smooth"}),history.replaceState(null,"",`#${f}`)}};return(u,f)=>t.toc.length?(b(),_("aside",Ge,[a("div",Je,p(y(o)("toc.title")),1),a("nav",null,[(b(!0),_(K,null,U(t.toc,s=>(b(),_("a",{key:s.id,class:"toc-item",style:J({paddingLeft:`${(s.level-1)*12}px`}),href:`#${s.id}`,onClick:l=>n(l,s.id)},p(s.text),13,Ke))),128))])])):D("",!0)}}),We=B(Ue,[["__scopeId","data-v-298d8e57"]]),Ye={class:"comments"},Qe={class:"comments__header"},Xe={class:"comments__count"},Ze={key:0,class:"comments__list"},Re={class:"comment__header"},et={class:"comment__author"},tt={class:"comment__time"},ot={class:"comment__content"},rt={key:1,class:"comments__empty"},nt={class:"form-row"},at=["placeholder"],st={class:"form-row"},ct=["placeholder"],lt={class:"submit-btn",type:"submit"},it=E({__name:"CommentSection",props:{comments:{},articleId:{}},emits:["submit"],setup(t,{emit:o}){const{t:n}=$(),u=o,f=Q({author:"",content:""}),s=()=>{const l=f.content.trim();l&&(u("submit",{author:f.author,content:l}),f.author="",f.content="")};return(l,m)=>(b(),_("section",Ye,[a("header",Qe,[a("h3",null,p(y(n)("comments.title")),1),a("span",Xe,p(y(n)("comments.count",{count:t.comments.length})),1)]),t.comments.length?(b(),_("ul",Ze,[(b(!0),_(K,null,U(t.comments,g=>(b(),_("li",{key:g.id,class:"comment"},[a("div",Re,[a("span",et,p(g.author),1),a("span",tt,p(new Date(g.createdAt).toLocaleString()),1)]),a("p",ot,p(g.content),1)]))),128))])):(b(),_("p",rt,p(y(n)("comments.empty")),1)),a("form",{class:"comment-form",onSubmit:X(s,["prevent"])},[a("div",nt,[a("label",null,[H(p(y(n)("comments.authorLabel"))+" ",1),N(a("input",{"onUpdate:modelValue":m[0]||(m[0]=g=>f.author=g),placeholder:y(n)("comments.authorPlaceholder")},null,8,at),[[O,f.author]])])]),a("div",st,[a("label",null,[H(p(y(n)("comments.contentLabel"))+" ",1),N(a("textarea",{"onUpdate:modelValue":m[1]||(m[1]=g=>f.content=g),rows:"4",required:"",placeholder:y(n)("comments.contentPlaceholder")},null,8,ct),[[O,f.content]])])]),a("button",lt,p(y(n)("comments.submit")),1)],32)]))}}),dt=B(it,[["__scopeId","data-v-a9391980"]]),ut={class:"layout detail-layout"},mt={class:"article-area"},ht={key:0,class:"detail-grid"},pt={class:"content-wrapper"},ft={key:1,class:"article-card detail-card empty-state"},vt={class:"card-body"},gt={class:"title"},Ct={class:"description"},yt=E({__name:"ArticleDetailPage",setup(t){const o=Z(),n=R(),{t:u}=$(),{loadComments:f,getComments:s,addComment:l}=fe(),m=T(()=>{const k=o.params.id;return k?te(k)??null:null}),g=T(()=>m.value?.content??""),r=pe(g),e=T(()=>m.value?A.findIndex(k=>k.id===m.value?.id):-1),c=T(()=>e.value>0?A[e.value-1]:null),d=T(()=>e.value>=0&&e.value<A.length-1?A[e.value+1]:null),i=T(()=>{const k=m.value?.id;return k?s(k):[]}),v=()=>{n.back()},h=()=>{c.value&&n.push({name:"articleDetail",params:{id:c.value.id}})},C=()=>{d.value&&n.push({name:"articleDetail",params:{id:d.value.id}})},w=()=>{m.value&&n.push({name:"articleEdit",params:{id:m.value.id}})},x=k=>{m.value&&l(m.value.id,k)};return G(()=>{f()}),(k,I)=>(b(),_("main",ut,[M(xe,{article:m.value,onGoBack:v,onEdit:w},null,8,["article"]),a("section",mt,[m.value?(b(),_("div",ht,[a("div",pt,[M(je,{article:m.value,"html-content":y(r).html,"prev-article":c.value??null,"next-article":d.value??null,onGoPrev:h,onGoNext:C},null,8,["article","html-content","prev-article","next-article"]),M(dt,{comments:i.value,"article-id":m.value.id,onSubmit:x},null,8,["comments","article-id"])]),M(We,{toc:y(r).toc},null,8,["toc"])])):(b(),_("article",ft,[a("div",vt,[a("h2",gt,p(y(u)("article.notFound")),1),a("p",Ct,p(y(u)("article.notFoundDesc")),1)])]))])]))}}),Lt=B(yt,[["__scopeId","data-v-266627e9"]]);export{Lt as default};
