import{c as y,r as H,d as x,u as k,a as f,b as r,j as S,t as m,e as p,i as v,n as M,o as N,w as K,f as z,F as O,h as j,x as U,z as Y,p as I,l as D,v as B,y as Q,k as A,q as W}from"./vue-vendor-D3XWct0c.js";import{g as X,a as L}from"./index-BhO533AK.js";import{r as Z,g as F,a as tt,M as et,i as ot}from"./markdown-vendor-BDlm1NQN.js";import{H as q}from"./highlight-vendor-2JJYcUgK.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b8 as P,b9 as nt}from"./math-vendor-B1UUFhUf.js";import{g as st}from"./coverStyle-BhxAb7xK.js";var rt=Z();const at=F(rt),b=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var ct=tt();const it=F(ct),lt=t=>t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"),E=new et({html:!0,linkify:!0,typographer:!0,breaks:!0,highlight:function(t,e){if(e==="flowchart"||e==="flow")return'<div class="flowchart-container"><pre class="flowchart" id="'+("flowchart-"+Math.random().toString(36).substr(2,9))+'">'+b(t)+"</pre></div>";if(e==="mermaid"||e==="sequenceDiagram"||e==="classDiagram"||e==="stateDiagram"||e==="erDiagram"||e==="journey"||e==="gantt"||e==="pie"||e==="requirement"||e==="gitgraph"||e==="mindmap"||e==="timeline")return'<div class="mermaid-container"><pre class="mermaid" id="'+("mermaid-"+Math.random().toString(36).substr(2,9))+'">'+b(t)+"</pre></div>";if(e&&q.getLanguage(e))try{return'<pre class="hljs"><code class="language-'+b(e)+'">'+q.highlight(t,{language:e}).value+"</code></pre>"}catch{}return'<pre class="hljs"><code>'+b(t)+"</code></pre>"}});E.use(ot);E.use(at);E.use(it,{enabled:!0,label:!0,labelAfter:!0});const V=t=>{if(!t||!Array.isArray(t))return"";let e="";for(const o of t)o?.type==="text"&&o.content||o?.type==="code_inline"&&o.content?e+=o.content:o?.children&&(e+=V(o.children));return e};E.use(function(t){const e=t.renderer.rules.heading_open||function(o,u,h,c,l){return l.renderToken(o,u,h)};t.renderer.rules.heading_open=function(o,u,h,c,l){const n=o[u];if(!n)return e(o,u,h,c,l);const i=parseInt(n.tag.slice(1));let a="",s=u+1;for(;s<o.length&&o[s]?.type!=="heading_close";){const w=o[s];if(w?.type==="inline"){w.children?a=V(w.children):a=w.content||"";break}s++}const d=lt(a),g=c.headingCount||{},C=g[d]||0;g[d]=C+1;const T=C?`${d}-${C}`:d;return c.toc||(c.toc=[]),c.toc.push({id:T,text:a,level:i}),n.attrSet("id",T),e(o,u,h,c,l)}});const dt=t=>{const e={toc:[],headingCount:{}};return{html:E.render(t,e),toc:e.toc||[]}},ut=t=>y(()=>dt(t.value||"")),mt=(t="article-comments")=>{const e=H({}),o=()=>{try{const l=localStorage.getItem(t);e.value=l?JSON.parse(l):{}}catch{e.value={}}},u=()=>{localStorage.setItem(t,JSON.stringify(e.value))};return{commentsMap:e,loadComments:o,getComments:l=>e.value[l]??[],addComment:(l,n)=>{const i=n.content.trim();if(!i)return;const a=n.author?.trim()||"匿名",s=e.value[l]??[],d={id:Date.now(),author:a,content:i,createdAt:new Date().toISOString()};return e.value={...e.value,[l]:[...s,d]},u(),d}}},ht={class:"hero detail-hero"},pt={class:"header-actions"},ft={key:0,class:"title-area"},vt={key:0,class:"badge"},gt={class:"meta"},_t={key:1,class:"title-area"},Ct={class:"meta"},yt=x({__name:"ArticleHeader",props:{article:{}},emits:["goBack","edit"],setup(t,{emit:e}){const o=e,{t:u}=k();return(h,c)=>(v(),f("section",ht,[r("div",pt,[r("button",{class:"back-btn",type:"button",onClick:c[0]||(c[0]=l=>o("goBack"))},"← "+m(p(u)("article.back")),1),t.article?(v(),f("button",{key:0,class:"edit-btn",type:"button",onClick:c[1]||(c[1]=l=>o("edit"))},"✎ "+m(p(u)("article.edit")),1)):S("",!0)]),t.article?(v(),f("div",ft,[t.article.badge?(v(),f("span",vt,m(t.article.badge),1)):S("",!0),r("h1",null,m(t.article.title),1),r("p",gt,[r("span",null,m(t.article.date),1),c[2]||(c[2]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.platform),1),c[3]||(c[3]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.tag),1)])])):(v(),f("div",_t,[r("h1",null,m(p(u)("article.notFound")),1),r("p",Ct,m(p(u)("article.notFoundDesc")),1)]))]))}}),wt=$(yt,[["__scopeId","data-v-0f3ff6f9"]]),bt=(t,e)=>{const u=e||(a=>({copy:"复制",copied:"已复制!",copyFailed:"复制失败",copyCode:"复制代码"})[a]||a),h=a=>{const s=a.textContent;a.textContent=u("copied"),a.classList.add("copied"),setTimeout(()=>{a.textContent=s,a.classList.remove("copied")},2e3)},c=a=>{const s=a.textContent;a.textContent=u("copyFailed"),a.classList.add("error"),setTimeout(()=>{a.textContent=s,a.classList.remove("error")},2e3)},l=async(a,s)=>{if(!navigator.clipboard||!navigator.clipboard.writeText){console.error("Clipboard API 不可用"),c(s);return}try{await navigator.clipboard.writeText(a),h(s)}catch(d){console.error("复制失败:",d),c(s)}},n=a=>{const s=document.createElement("button");return s.className="copy-code-btn",s.textContent=u("copy"),s.type="button",s.setAttribute("aria-label",u("copyCode")),s.addEventListener("click",()=>{l(a,s)}),s};return{addCopyButtons:()=>{M(()=>{if(!t.value)return;t.value.querySelectorAll("pre.hljs").forEach(s=>{if(s.querySelector(".copy-code-btn"))return;const d=s.querySelector("code");if(!d)return;const g=d.textContent||d.innerText||"",C=n(g);s.appendChild(C)})})}}},xt=t=>{let e=!1;const o=()=>{e||(P.initialize({startOnLoad:!1,theme:"default",securityLevel:"loose"}),e=!0)},u=l=>{const n=l.id||"mermaid-"+Math.random().toString(36).substr(2,9),i=l.textContent||"";if(!i.trim())return;l.classList.add("mermaid-rendered");const a=n+"-svg";P.render(a,i).then(s=>{const d=l.parentElement;d&&d.classList.contains("mermaid-container")?d.innerHTML=s.svg:l.innerHTML=s.svg}).catch(s=>{console.error("Mermaid 渲染失败:",s),h(l,i)})},h=(l,n)=>{const i=l.parentElement;i&&i.classList.contains("mermaid-container")&&(i.innerHTML='<pre class="mermaid-error">'+b(n)+"</pre>")};return{initMermaid:()=>{M(()=>{if(!t.value)return;o(),t.value.querySelectorAll("pre.mermaid:not(.mermaid-rendered)").forEach(n=>{u(n)})})}}};var kt=nt();const $t=F(kt),Et=t=>{const e=()=>{const n=document.documentElement.classList.contains("dark");return{textColor:n?"#e0e0e0":"#000000",lineColor:n?"#e0e0e0":"#000000",fillColor:n?"#2a2a2a":"#ffffff",isDark:n}},o=()=>{const{textColor:n,lineColor:i,fillColor:a,isDark:s}=e();return{"line-width":2,"line-length":50,"text-margin":10,"font-size":14,"font-color":n,"line-color":i,"element-color":n,fill:a,"yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,flowstate:{past:{fill:s?"#444444":"#CCCCCC","font-size":12},current:{fill:s?"#4a4a00":"yellow","font-color":s?"#ff6b6b":"red","font-weight":"bold"},future:{fill:s?"#666600":"#FFFF99"},request:{fill:s?"#003366":"blue"},invalid:{fill:s?"#222222":"#444444"},approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}}},u=n=>{const i=document.createElement("div");return i.className="flowchart-svg-container",i.id=n+"-svg",i},h=n=>{const i=n.id||"flowchart-"+Math.random().toString(36).substr(2,9),a=n.textContent||"";if(a.trim()){n.classList.add("flowchart-rendered");try{const s=$t.parse(a),d=u(i),g=n.parentElement;if(g&&g.classList.contains("flowchart-container")){g.innerHTML="",g.appendChild(d);const C=o();s.drawSVG(i+"-svg",C)}}catch(s){console.error("Flowchart 渲染失败:",s),c(n,a)}}},c=(n,i)=>{const a=n.parentElement;a&&a.classList.contains("flowchart-container")&&(a.innerHTML='<pre class="flowchart-error">'+b(i)+"</pre>")};return{initFlowchart:()=>{M(()=>{if(!t.value)return;t.value.querySelectorAll("pre.flowchart:not(.flowchart-rendered)").forEach(i=>{h(i)})})}}},Tt={class:"article-card detail-card"},At={key:0,class:"badge"},Lt={class:"card-body"},St={class:"tag-row"},Mt={class:"tag"},Ft={class:"title"},It={class:"description"},Dt={class:"meta"},Bt={class:"nav-row"},qt=["disabled"],Pt=["disabled"],Ht=["innerHTML"],Nt=x({__name:"ArticleContent",props:{article:{},htmlContent:{},prevArticle:{},nextArticle:{}},emits:["goPrev","goNext"],setup(t,{emit:e}){const{t:o}=k(),u=t,h=e,c=H(),{addCopyButtons:l}=bt(c,s=>({copy:o("code.copy"),copied:o("code.copied"),copyFailed:o("code.copyFailed"),copyCode:o("code.copyCode")})[s]||s),{initMermaid:n}=xt(c),{initFlowchart:i}=Et(c),a=()=>{l(),n(),i()};return N(()=>{a()}),K(()=>u.htmlContent,()=>{a()}),(s,d)=>(v(),f("article",Tt,[r("div",{class:"card-cover",style:z(p(st)(t.article.cover))},[t.article.badge?(v(),f("span",At,m(t.article.badge),1)):S("",!0)],4),r("div",Lt,[r("div",St,[r("span",Mt,m(t.article.tag),1)]),r("h2",Ft,m(t.article.title),1),r("p",It,m(t.article.description),1),r("div",Dt,[r("span",null,m(t.article.date),1),d[2]||(d[2]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.platform),1),d[3]||(d[3]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.tag),1)]),r("div",Bt,[r("button",{class:"ghost-btn",type:"button",disabled:!t.prevArticle,onClick:d[0]||(d[0]=g=>h("goPrev"))}," ← "+m(p(o)("article.prevArticle")),9,qt),r("button",{class:"ghost-btn",type:"button",disabled:!t.nextArticle,onClick:d[1]||(d[1]=g=>h("goNext"))},m(p(o)("article.nextArticle"))+" → ",9,Pt)]),r("div",{ref_key:"contentBlockRef",ref:c,class:"content-block",innerHTML:t.htmlContent},null,8,Ht)])]))}}),zt=$(Nt,[["__scopeId","data-v-58229f07"]]),Ot={key:0,class:"toc"},jt={class:"toc-title"},Vt=["href","onClick"],Rt=x({__name:"ArticleTOC",props:{toc:{}},setup(t){const{t:e}=k(),o=(u,h)=>{u.preventDefault();const c=document.getElementById(h);if(c){const i=c.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:i,behavior:"smooth"}),history.replaceState(null,"",`#${h}`)}};return(u,h)=>t.toc.length?(v(),f("aside",Ot,[r("div",jt,m(p(e)("toc.title")),1),r("nav",null,[(v(!0),f(O,null,j(t.toc,c=>(v(),f("a",{key:c.id,class:"toc-item",style:z({paddingLeft:`${(c.level-1)*12}px`}),href:`#${c.id}`,onClick:l=>o(l,c.id)},m(c.text),13,Vt))),128))])])):S("",!0)}}),Gt=$(Rt,[["__scopeId","data-v-298d8e57"]]),Jt={class:"comments"},Kt={class:"comments__header"},Ut={class:"comments__count"},Yt={key:0,class:"comments__list"},Qt={class:"comment__header"},Wt={class:"comment__author"},Xt={class:"comment__time"},Zt={class:"comment__content"},te={key:1,class:"comments__empty"},ee={class:"form-row"},oe=["placeholder"],ne={class:"form-row"},se=["placeholder"],re={class:"submit-btn",type:"submit"},ae=x({__name:"CommentSection",props:{comments:{},articleId:{}},emits:["submit"],setup(t,{emit:e}){const{t:o}=k(),u=e,h=U({author:"",content:""}),c=()=>{const l=h.content.trim();l&&(u("submit",{author:h.author,content:l}),h.author="",h.content="")};return(l,n)=>(v(),f("section",Jt,[r("header",Kt,[r("h3",null,m(p(o)("comments.title")),1),r("span",Ut,m(p(o)("comments.count",{count:t.comments.length})),1)]),t.comments.length?(v(),f("ul",Yt,[(v(!0),f(O,null,j(t.comments,i=>(v(),f("li",{key:i.id,class:"comment"},[r("div",Qt,[r("span",Wt,m(i.author),1),r("span",Xt,m(new Date(i.createdAt).toLocaleString()),1)]),r("p",Zt,m(i.content),1)]))),128))])):(v(),f("p",te,m(p(o)("comments.empty")),1)),r("form",{class:"comment-form",onSubmit:Y(c,["prevent"])},[r("div",ee,[r("label",null,[I(m(p(o)("comments.authorLabel"))+" ",1),D(r("input",{"onUpdate:modelValue":n[0]||(n[0]=i=>h.author=i),placeholder:p(o)("comments.authorPlaceholder")},null,8,oe),[[B,h.author]])])]),r("div",ne,[r("label",null,[I(m(p(o)("comments.contentLabel"))+" ",1),D(r("textarea",{"onUpdate:modelValue":n[1]||(n[1]=i=>h.content=i),rows:"4",required:"",placeholder:p(o)("comments.contentPlaceholder")},null,8,se),[[B,h.content]])])]),r("button",re,m(p(o)("comments.submit")),1)],32)]))}}),ce=$(ae,[["__scopeId","data-v-a9391980"]]),ie={class:"layout detail-layout"},le={class:"article-area"},de={key:0,class:"detail-grid"},ue={class:"content-wrapper"},me={key:1,class:"article-card detail-card empty-state"},he={class:"card-body"},pe={class:"title"},fe={class:"description"},ve=x({__name:"ArticleDetailPage",setup(t){const e=Q(),o=W(),{t:u}=k(),{loadComments:h,getComments:c,addComment:l}=mt(),n=y(()=>{const _=e.params.id;return _?X(_)??null:null}),i=y(()=>n.value?.content??""),a=ut(i),s=y(()=>n.value?L.findIndex(_=>_.id===n.value?.id):-1),d=y(()=>s.value>0?L[s.value-1]:null),g=y(()=>s.value>=0&&s.value<L.length-1?L[s.value+1]:null),C=y(()=>{const _=n.value?.id;return _?c(_):[]}),T=()=>{o.back()},w=()=>{d.value&&o.push({name:"articleDetail",params:{id:d.value.id}})},R=()=>{g.value&&o.push({name:"articleDetail",params:{id:g.value.id}})},G=()=>{n.value&&o.push({name:"articleEdit",params:{id:n.value.id}})},J=_=>{n.value&&l(n.value.id,_)};return N(()=>{h()}),(_,ge)=>(v(),f("main",ie,[A(wt,{article:n.value,onGoBack:T,onEdit:G},null,8,["article"]),r("section",le,[n.value?(v(),f("div",de,[r("div",ue,[A(zt,{article:n.value,"html-content":p(a).html,"prev-article":d.value??null,"next-article":g.value??null,onGoPrev:w,onGoNext:R},null,8,["article","html-content","prev-article","next-article"]),A(ce,{comments:C.value,"article-id":n.value.id,onSubmit:J},null,8,["comments","article-id"])]),A(Gt,{toc:p(a).toc},null,8,["toc"])])):(v(),f("article",me,[r("div",he,[r("h2",pe,m(p(u)("article.notFound")),1),r("p",fe,m(p(u)("article.notFoundDesc")),1)])]))])]))}}),$e=$(ve,[["__scopeId","data-v-266627e9"]]);export{$e as default};
