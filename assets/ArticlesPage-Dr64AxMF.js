import{r as D,c as w,d as L,u as B,a as i,b as t,m as k,t as r,g as x,e as g,F as T,h as M,i as l,y as F,f as Y,k as E,w as H,z as J,A as W,s as X,v as Z,B as G,q as K}from"./vue-vendor-BdTyEF2a.js";import{a as A}from"./index-C_vbMhhH.js";import{u as ee}from"./useCategories-BKx7xYjf.js";import{g as q}from"./coverStyle-BhxAb7xK.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./math-vendor-nrgBiNG-.js";import"./markdown-vendor-BDlm1NQN.js";const te=h=>{const c=D(""),b=(v,a)=>{if(!a.trim())return v;const m=new RegExp(`(${a})`,"gi");return v.replace(m,"<mark>$1</mark>")},P=w(()=>{const v=c.value.trim().toLowerCase();return v?h.filter(a=>[a.title,a.description,a.content,a.tag,a.categoryKey].join(" ").toLowerCase().includes(v)):h}),p=w(()=>{const v=c.value.trim();return v?P.value.map(a=>({...a,highlightedTitle:b(a.title,v),highlightedDescription:b(a.description,v)})):[]});return{searchQuery:c,searchResults:P,highlightedResults:p,clearSearch:()=>{c.value=""}}},se={class:"pagination"},ae={class:"pagination-controls"},ne={key:0,class:"total-items"},oe={key:1,class:"pagination-buttons"},le=["disabled"],ie={class:"page-numbers"},re=["disabled","onClick"],ce=["disabled"],ue={class:"items-per-page"},de=["value"],ge=["value"],he=L({__name:"Pagination",props:{currentPage:{default:1},totalPages:{default:1},totalItems:{default:0},itemsPerPage:{default:5},itemsPerPageOptions:{default:()=>[5,10,20,50]}},emits:["update:currentPage","update:itemsPerPage","page-change"],setup(h,{emit:c}){const{t:b}=B(),P=h,p=c,C=w(()=>{const e=[],u=P.totalPages,_=P.currentPage;if(u<=7)for(let n=1;n<=u;n++)e.push(n);else if(_<=3){for(let n=1;n<=4;n++)e.push(n);e.push("..."),e.push(u)}else if(_>=u-2){e.push(1),e.push("...");for(let n=u-3;n<=u;n++)e.push(n)}else{e.push(1),e.push("...");for(let n=_-1;n<=_+1;n++)e.push(n);e.push("..."),e.push(u)}return e}),v=e=>{typeof e=="number"&&e>=1&&e<=P.totalPages&&(p("update:currentPage",e),p("page-change",e),window.scrollTo({top:0,behavior:"smooth"}))},a=()=>{if(P.currentPage>1){const e=P.currentPage-1;p("update:currentPage",e),p("page-change",e),window.scrollTo({top:0,behavior:"smooth"})}},m=()=>{if(P.currentPage<P.totalPages){const e=P.currentPage+1;p("update:currentPage",e),p("page-change",e),window.scrollTo({top:0,behavior:"smooth"})}},y=e=>{const u=e.target,_=parseInt(u.value,10);p("update:itemsPerPage",_),p("update:currentPage",1),p("page-change",1),window.scrollTo({top:0,behavior:"smooth"})};return(e,u)=>(l(),i("div",se,[t("div",ae,[h.totalItems>0?(l(),i("div",ne," å…± "+r(h.totalItems)+" æ¡ ",1)):k("",!0),h.totalPages>1?(l(),i("div",oe,[t("button",{class:x(["page-btn",{disabled:h.currentPage===1}]),disabled:h.currentPage===1,onClick:a},r(g(b)("pagination.prev")),11,le),t("div",ie,[(l(!0),i(T,null,M(C.value,_=>(l(),i("button",{key:_,class:x(["page-number",{active:_===h.currentPage,ellipsis:_==="..."}]),disabled:_==="...",onClick:n=>v(_)},r(_),11,re))),128))]),t("button",{class:x(["page-btn",{disabled:h.currentPage===h.totalPages}]),disabled:h.currentPage===h.totalPages,onClick:m},r(g(b)("pagination.next")),11,ce)])):k("",!0),t("div",ue,[t("select",{value:h.itemsPerPage,class:"items-per-page-select",onChange:y},[(l(!0),i(T,null,M(h.itemsPerPageOptions,_=>(l(),i("option",{key:_,value:_},r(_)+" / page ",9,ge))),128))],40,de)])])]))}}),pe=R(he,[["__scopeId","data-v-6c653ad1"]]),ve={class:"timeline-view"},me={class:"timeline-container"},_e={class:"timeline-year-node"},ye={class:"year-circle"},Pe={class:"timeline-articles"},be=["onClick","onKeyup"],fe={class:"timeline-content"},ke={key:0,class:"timeline-badge"},we={class:"timeline-info"},$e={class:"timeline-date"},Te={class:"updated-date"},Ce=["innerHTML"],De=["innerHTML"],Me={key:0,class:"empty-state"},xe=L({__name:"TimelineView",props:{articles:{},sortDesc:{type:Boolean},currentPage:{},itemsPerPage:{}},setup(h){const c=h,{t:b}=B(),P=E(),p=a=>{P.push({name:"articleDetail",params:{id:a}})},C=w(()=>{const a={};return c.articles.forEach(y=>{const e=new Date(y.date).getFullYear().toString();a[e]||(a[e]=[]),a[e].push(y)}),Object.keys(a).sort((y,e)=>c.sortDesc?Number(e)-Number(y):Number(y)-Number(e)).map(y=>({year:y,articles:a[y]}))}),v=w(()=>{const a=C.value.flatMap(n=>(n.articles||[]).map(f=>({...f,year:n.year}))),m=(c.currentPage-1)*c.itemsPerPage,y=m+c.itemsPerPage,e=a.slice(m,y),u={};return e.forEach(n=>{const f=n.year;u[f]||(u[f]=[]),u[f].push(n)}),Object.keys(u).sort((n,f)=>c.sortDesc?Number(f)-Number(n):Number(n)-Number(f)).map(n=>({year:n,articles:u[n]||[]}))});return(a,m)=>(l(),i("div",ve,[t("div",me,[m[3]||(m[3]=t("div",{class:"timeline-line"},null,-1)),(l(!0),i(T,null,M(v.value,y=>(l(),i("div",{key:y.year,class:"timeline-year-group"},[t("div",_e,[t("div",ye,r(y.year),1)]),t("div",Pe,[(l(!0),i(T,null,M(y.articles,e=>(l(),i("article",{key:e.id,class:"timeline-article",role:"button",tabindex:"0",onClick:u=>p(e.id),onKeyup:F(u=>p(e.id),["enter"])},[m[2]||(m[2]=t("div",{class:"timeline-dot"},null,-1)),t("div",fe,[t("div",{class:"timeline-thumbnail",style:Y(g(q)(e.cover))},[e.badge?(l(),i("span",ke,r(e.badge),1)):k("",!0)],4),t("div",we,[t("div",$e,[m[1]||(m[1]=t("span",{class:"date-icon"},"ðŸ“…",-1)),t("span",null,r(e.date),1),e.updatedDate&&e.updatedDate!==e.date?(l(),i(T,{key:0},[m[0]||(m[0]=t("span",{class:"date-separator"},"Â·",-1)),t("span",Te,r(g(b)("article.updated"))+": "+r(e.updatedDate),1)],64)):k("",!0)]),t("h3",{class:"timeline-title",innerHTML:e.highlightedTitle||e.title},null,8,Ce),e.description?(l(),i("p",{key:0,class:"timeline-description",innerHTML:e.highlightedDescription||e.description},null,8,De)):k("",!0)])])],40,be))),128))])]))),128))]),h.articles.length===0?(l(),i("div",Me,[t("p",null,r(g(b)("search.noResults")),1)])):k("",!0)]))}}),Ne=R(xe,[["__scopeId","data-v-7c65b752"]]),Se={class:"layout"},Ve={class:"content"},Ie={class:"sidebar"},Ae={class:"filter-title"},Le={class:"category-list"},Be=["onClick"],Re={class:"category-label"},He={class:"category-count"},Ke={class:"article-area"},Fe={class:"search-section"},Ye={class:"search-box"},Ee=["placeholder"],qe={class:"list-header"},Oe={class:"article-count"},je={key:0,class:"search-hint"},ze={class:"header-actions"},Ue=["title"],Qe={key:0},Je={key:1},We={key:0,class:"articles"},Xe=["onClick","onKeyup"],Ze={key:0,class:"badge"},Ge={class:"card-body"},et={class:"tag-row"},tt={class:"tag"},st=["innerHTML"],at=["innerHTML"],nt={class:"meta"},ot={key:0,class:"empty-state"},lt=L({__name:"ArticlesPage",setup(h){const{t:c}=B(),b=E(),{categories:P}=ee(!0),p=D("all"),C=w(()=>{const d={};return d.all=A.length,P.value.forEach(o=>{o.key!=="all"&&(d[o.key]=A.filter(s=>s.categoryKey===o.key).length)}),d}),v=D(!0),{searchQuery:a,searchResults:m,highlightedResults:y}=te(A),e=D(5),u=D(1),n=D((()=>{try{const d=localStorage.getItem("articleViewMode");if(d==="list"||d==="timeline")return d}catch(d){console.warn("Failed to read view mode from localStorage:",d)}return"list"})()),f=d=>{b.push({name:"articleDetail",params:{id:d}})},O=()=>{b.push({name:"articleNew"})},I=w(()=>{let d=m.value;return p.value!=="all"&&(d=d.filter(o=>o.categoryKey===p.value)),d.slice().sort((o,s)=>{const $=new Date(o.date).getTime(),V=new Date(s.date).getTime();return v.value?V-$:$-V})}),N=w(()=>{const d=a.value.trim();let o=I.value;return d&&(o=o.map(s=>{const $=y.value.find(V=>V.id===s.id);return $?{...s,highlightedTitle:$.highlightedTitle,highlightedDescription:$.highlightedDescription}:s})),o}),j=w(()=>{const d=(u.value-1)*e.value,o=d+e.value;return N.value.slice(d,o)}),z=w(()=>Math.ceil(N.value.length/e.value)),S=()=>{u.value=1};H([a,p,v],()=>{S()});const U=()=>{v.value=!v.value,S()},Q=()=>{n.value=n.value==="list"?"timeline":"list",S()};return H(n,d=>{try{localStorage.setItem("articleViewMode",d)}catch(o){console.warn("Failed to save view mode to localStorage:",o)}}),(d,o)=>(l(),i("main",Se,[t("section",Ve,[t("aside",Ie,[t("div",Ae,[o[4]||(o[4]=t("span",{class:"filter-icon"},"âŒ˜",-1)),t("span",null,r(g(c)("filter.category")),1)]),t("div",Le,[(l(!0),i(T,null,M(g(P),s=>(l(),i("button",{key:s.key,class:x(["category-item",{active:p.value===s.key}]),type:"button",onClick:$=>{p.value=s.key,S()}},[t("span",Re,r(s.label),1),t("span",He,"("+r(C.value[s.key]||0)+")",1)],10,Be))),128))])]),t("section",Ke,[t("div",Fe,[t("div",Ye,[o[5]||(o[5]=t("span",{class:"search-icon"},"ðŸ”",-1)),X(t("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>G(a)?a.value=s:null),type:"text",class:"search-input",placeholder:g(c)("search.placeholder")},null,8,Ee),[[Z,g(a)]]),g(a)?(l(),i("button",{key:0,class:"clear-btn",type:"button",onClick:o[1]||(o[1]=s=>a.value="")}," Ã— ")):k("",!0)])]),t("div",qe,[t("div",Oe,[K(r(g(c)("articles.count",{count:I.value.length}))+" ",1),g(a)?(l(),i("span",je,r(g(c)("search.results",{query:g(a)})),1)):k("",!0)]),t("div",ze,[t("button",{class:"view-toggle-btn",type:"button",onClick:Q,title:n.value==="list"?g(c)("actions.timelineView"):g(c)("actions.listView")},[n.value==="list"?(l(),i("span",Qe,"ðŸ“…")):(l(),i("span",Je,"ðŸ“‹"))],8,Ue),t("button",{class:"new-article-btn",type:"button",onClick:O}," + "+r(g(c)("article.new")),1),t("button",{class:"sort-btn",type:"button",onClick:U},[K(r(g(c)("actions.sortByTime"))+" ",1),t("span",{class:x(["arrow",{rotated:!v.value}])},"âŒ„",2)])])]),n.value==="list"?(l(),i("div",We,[(l(!0),i(T,null,M(j.value,s=>(l(),i("article",{key:s.id,class:"article-card",role:"button",tabindex:"0",onClick:$=>f(s.id),onKeyup:F($=>f(s.id),["enter"])},[t("div",{class:"card-cover",style:Y(g(q)(s.cover))},[s.badge?(l(),i("span",Ze,r(s.badge),1)):k("",!0)],4),t("div",Ge,[t("div",et,[t("span",tt,r(s.tag),1)]),t("span",{class:"title",innerHTML:s.highlightedTitle||s.title},null,8,st),t("p",{class:"description",innerHTML:s.highlightedDescription||s.description},null,8,at),t("div",nt,[t("span",null,r(g(c)("article.created"))+": "+r(s.date),1),s.updatedDate?(l(),i(T,{key:0},[o[6]||(o[6]=t("span",{class:"dot"},"Â·",-1)),t("span",null,r(g(c)("article.updated"))+": "+r(s.updatedDate),1)],64)):k("",!0),o[7]||(o[7]=t("span",{class:"dot"},"Â·",-1)),t("span",null,r(s.platform),1)])])],40,Xe))),128)),I.value.length===0?(l(),i("div",ot,[t("p",null,r(g(c)("search.noResults")),1)])):k("",!0)])):(l(),J(Ne,{key:1,articles:N.value,"sort-desc":v.value,"current-page":u.value,"items-per-page":e.value},null,8,["articles","sort-desc","current-page","items-per-page"])),W(pe,{"current-page":u.value,"onUpdate:currentPage":o[2]||(o[2]=s=>u.value=s),"items-per-page":e.value,"onUpdate:itemsPerPage":o[3]||(o[3]=s=>e.value=s),"total-pages":z.value,"total-items":N.value.length,"items-per-page-options":[5,10,20,50]},null,8,["current-page","items-per-page","total-pages","total-items"])])])]))}}),pt=R(lt,[["__scopeId","data-v-d64b432d"]]);export{pt as default};
