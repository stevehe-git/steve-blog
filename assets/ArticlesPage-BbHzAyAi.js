import{r as D,c as P,d as E,u as j,a as l,b as e,j as f,t as r,g as x,e as d,F as T,h as M,i,w as H,k as Z,l as G,v as ee,m as te,p as K,q as se,s as F,f as Y}from"./vue-vendor-D3XWct0c.js";import{a as R}from"./index-Ev4OlaW9.js";import{u as ae}from"./useCategories-BYgl4rKb.js";import{g as B}from"./coverStyle-BhxAb7xK.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./math-vendor-SLPsJVAw.js";import"./markdown-vendor-BDlm1NQN.js";const ne=v=>{const g=D(""),w=(h,c)=>{if(!c.trim())return h;const $=new RegExp(`(${c})`,"gi");return h.replace($,"<mark>$1</mark>")},y=P(()=>{const h=g.value.trim().toLowerCase();return h?v.filter(c=>[c.title,c.description,c.content,c.tag,c.categoryKey].join(" ").toLowerCase().includes(h)):v}),m=P(()=>{const h=g.value.trim();return h?y.value.map(c=>({...c,highlightedTitle:w(c.title,h),highlightedDescription:w(c.description,h)})):[]});return{searchQuery:g,searchResults:y,highlightedResults:m,clearSearch:()=>{g.value=""}}},oe={class:"pagination"},le={class:"pagination-controls"},ie={key:0,class:"total-items"},re={key:1,class:"pagination-buttons"},ce=["disabled"],ue={class:"page-numbers"},de=["disabled","onClick"],ge=["disabled"],he={class:"items-per-page"},pe=["value"],ve=["value"],me=E({__name:"Pagination",props:{currentPage:{default:1},totalPages:{default:1},totalItems:{default:0},itemsPerPage:{default:5},itemsPerPageOptions:{default:()=>[5,10,20,50]}},emits:["update:currentPage","update:itemsPerPage","page-change"],setup(v,{emit:g}){const{t:w}=j(),y=v,m=g,S=P(()=>{const a=[],_=y.totalPages,p=y.currentPage;if(_<=7)for(let u=1;u<=_;u++)a.push(u);else if(p<=3){for(let u=1;u<=4;u++)a.push(u);a.push("..."),a.push(_)}else if(p>=_-2){a.push(1),a.push("...");for(let u=_-3;u<=_;u++)a.push(u)}else{a.push(1),a.push("...");for(let u=p-1;u<=p+1;u++)a.push(u);a.push("..."),a.push(_)}return a}),h=a=>{typeof a=="number"&&a>=1&&a<=y.totalPages&&(m("update:currentPage",a),m("page-change",a),window.scrollTo({top:0,behavior:"smooth"}))},c=()=>{if(y.currentPage>1){const a=y.currentPage-1;m("update:currentPage",a),m("page-change",a),window.scrollTo({top:0,behavior:"smooth"})}},$=()=>{if(y.currentPage<y.totalPages){const a=y.currentPage+1;m("update:currentPage",a),m("page-change",a),window.scrollTo({top:0,behavior:"smooth"})}},L=a=>{const _=a.target,p=parseInt(_.value,10);m("update:itemsPerPage",p),m("update:currentPage",1),m("page-change",1),window.scrollTo({top:0,behavior:"smooth"})};return(a,_)=>(i(),l("div",oe,[e("div",le,[v.totalItems>0?(i(),l("div",ie," å…± "+r(v.totalItems)+" æ¡ ",1)):f("",!0),v.totalPages>1?(i(),l("div",re,[e("button",{class:x(["page-btn",{disabled:v.currentPage===1}]),disabled:v.currentPage===1,onClick:c},r(d(w)("pagination.prev")),11,ce),e("div",ue,[(i(!0),l(T,null,M(S.value,p=>(i(),l("button",{key:p,class:x(["page-number",{active:p===v.currentPage,ellipsis:p==="..."}]),disabled:p==="...",onClick:u=>h(p)},r(p),11,de))),128))]),e("button",{class:x(["page-btn",{disabled:v.currentPage===v.totalPages}]),disabled:v.currentPage===v.totalPages,onClick:$},r(d(w)("pagination.next")),11,ge)])):f("",!0),e("div",he,[e("select",{value:v.itemsPerPage,class:"items-per-page-select",onChange:L},[(i(!0),l(T,null,M(v.itemsPerPageOptions,p=>(i(),l("option",{key:p,value:p},r(p)+" / page ",9,ve))),128))],40,pe)])])]))}}),_e=q(me,[["__scopeId","data-v-6c653ad1"]]),ye={class:"layout"},be={class:"content"},fe={class:"sidebar"},Pe={class:"filter-title"},ke={class:"category-list"},we=["onClick"],Ce={class:"category-label"},Te={class:"category-count"},$e={class:"article-area"},De={class:"search-section"},Me={class:"search-box"},Ne=["placeholder"],xe={class:"list-header"},Se={class:"article-count"},Ve={key:0,class:"search-hint"},Ie={class:"header-actions"},Le=["title"],Ae={key:0},Re={key:1},He={key:0,class:"articles"},Ke=["onClick","onKeyup"],Fe={key:0,class:"badge"},Ye={class:"card-body"},Be={class:"tag-row"},Ee={class:"tag"},je=["innerHTML"],qe=["innerHTML"],Oe={class:"meta"},Ue={key:0,class:"empty-state"},ze={key:1,class:"timeline-view"},Qe={class:"timeline-container"},Je={class:"timeline-year-node"},We={class:"year-circle"},Xe={class:"timeline-articles"},Ze=["onClick","onKeyup"],Ge={class:"timeline-content"},et={key:0,class:"timeline-badge"},tt={class:"timeline-info"},st={class:"timeline-date"},at={class:"updated-date"},nt=["innerHTML"],ot=["innerHTML"],lt={key:0,class:"empty-state"},it=E({__name:"ArticlesPage",setup(v){const{t:g}=j(),w=se(),{categories:y}=ae(!0),m=D("all"),S=P(()=>{const o={};return o.all=R.length,y.value.forEach(s=>{s.key!=="all"&&(o[s.key]=R.filter(t=>t.categoryKey===s.key).length)}),o}),h=D(!0),{searchQuery:c,searchResults:$,highlightedResults:L}=ne(R),a=D(5),_=D(1),u=D((()=>{try{const o=localStorage.getItem("articleViewMode");if(o==="list"||o==="timeline")return o}catch(o){console.warn("Failed to read view mode from localStorage:",o)}return"list"})()),V=o=>{w.push({name:"articleDetail",params:{id:o}})},O=()=>{w.push({name:"articleNew"})},N=P(()=>{let o=$.value;return m.value!=="all"&&(o=o.filter(s=>s.categoryKey===m.value)),o.slice().sort((s,t)=>{const n=new Date(s.date).getTime()-new Date(t.date).getTime();return h.value?-n:n})}),A=P(()=>{const o=c.value.trim();let s=N.value;return o&&(s=s.map(t=>{const n=L.value.find(k=>k.id===t.id);return n?{...t,highlightedTitle:n.highlightedTitle,highlightedDescription:n.highlightedDescription}:t})),s}),U=P(()=>{const o=(_.value-1)*a.value,s=o+a.value;return A.value.slice(o,s)}),z=P(()=>Math.ceil(A.value.length/a.value)),I=()=>{_.value=1};H([c,m,h],()=>{I()});const Q=()=>{h.value=!h.value,I()},J=()=>{u.value=u.value==="list"?"timeline":"list",I()};H(u,o=>{try{localStorage.setItem("articleViewMode",o)}catch(s){console.warn("Failed to save view mode to localStorage:",s)}});const W=P(()=>{const o={};return N.value.forEach(t=>{const n=new Date(t.date).getFullYear().toString();o[n]||(o[n]=[]),o[n].push(t)}),Object.keys(o).sort((t,n)=>h.value?Number(n)-Number(t):Number(t)-Number(n)).map(t=>({year:t,articles:o[t]}))}),X=P(()=>{const o=W.value.flatMap(b=>(b.articles||[]).map(C=>({...C,year:b.year}))),s=(_.value-1)*a.value,t=s+a.value,n=o.slice(s,t),k={};return n.forEach(b=>{const C=b.year;k[C]||(k[C]=[]),k[C].push(b)}),Object.keys(k).sort((b,C)=>h.value?Number(C)-Number(b):Number(b)-Number(C)).map(b=>({year:b,articles:k[b]||[]}))});return(o,s)=>(i(),l("main",ye,[e("section",be,[e("aside",fe,[e("div",Pe,[s[4]||(s[4]=e("span",{class:"filter-icon"},"âŒ˜",-1)),e("span",null,r(d(g)("filter.category")),1)]),e("div",ke,[(i(!0),l(T,null,M(d(y),t=>(i(),l("button",{key:t.key,class:x(["category-item",{active:m.value===t.key}]),type:"button",onClick:n=>{m.value=t.key,I()}},[e("span",Ce,r(t.label),1),e("span",Te,"("+r(S.value[t.key]||0)+")",1)],10,we))),128))])]),e("section",$e,[e("div",De,[e("div",Me,[s[5]||(s[5]=e("span",{class:"search-icon"},"ðŸ”",-1)),G(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>te(c)?c.value=t:null),type:"text",class:"search-input",placeholder:d(g)("search.placeholder")},null,8,Ne),[[ee,d(c)]]),d(c)?(i(),l("button",{key:0,class:"clear-btn",type:"button",onClick:s[1]||(s[1]=t=>c.value="")}," Ã— ")):f("",!0)])]),e("div",xe,[e("div",Se,[K(r(d(g)("articles.count",{count:N.value.length}))+" ",1),d(c)?(i(),l("span",Ve,r(d(g)("search.results",{query:d(c)})),1)):f("",!0)]),e("div",Ie,[e("button",{class:"view-toggle-btn",type:"button",onClick:J,title:u.value==="list"?d(g)("actions.timelineView"):d(g)("actions.listView")},[u.value==="list"?(i(),l("span",Ae,"ðŸ“…")):(i(),l("span",Re,"ðŸ“‹"))],8,Le),e("button",{class:"new-article-btn",type:"button",onClick:O}," + "+r(d(g)("article.new")),1),e("button",{class:"sort-btn",type:"button",onClick:Q},[K(r(d(g)("actions.sortByTime"))+" ",1),e("span",{class:x(["arrow",{rotated:!h.value}])},"âŒ„",2)])])]),u.value==="list"?(i(),l("div",He,[(i(!0),l(T,null,M(U.value,t=>(i(),l("article",{key:t.id,class:"article-card",role:"button",tabindex:"0",onClick:n=>V(t.id),onKeyup:F(n=>V(t.id),["enter"])},[e("div",{class:"card-cover",style:Y(d(B)(t.cover))},[t.badge?(i(),l("span",Fe,r(t.badge),1)):f("",!0)],4),e("div",Ye,[e("div",Be,[e("span",Ee,r(t.tag),1)]),e("span",{class:"title",innerHTML:t.highlightedTitle||t.title},null,8,je),e("p",{class:"description",innerHTML:t.highlightedDescription||t.description},null,8,qe),e("div",Oe,[e("span",null,r(d(g)("article.created"))+": "+r(t.date),1),t.updatedDate?(i(),l(T,{key:0},[s[6]||(s[6]=e("span",{class:"dot"},"Â·",-1)),e("span",null,r(d(g)("article.updated"))+": "+r(t.updatedDate),1)],64)):f("",!0),s[7]||(s[7]=e("span",{class:"dot"},"Â·",-1)),e("span",null,r(t.platform),1)])])],40,Ke))),128)),N.value.length===0?(i(),l("div",Ue,[e("p",null,r(d(g)("search.noResults")),1)])):f("",!0)])):(i(),l("div",ze,[e("div",Qe,[s[11]||(s[11]=e("div",{class:"timeline-line"},null,-1)),(i(!0),l(T,null,M(X.value,t=>(i(),l("div",{key:t.year,class:"timeline-year-group"},[e("div",Je,[e("div",We,r(t.year),1)]),e("div",Xe,[(i(!0),l(T,null,M(t.articles,n=>(i(),l("article",{key:n.id,class:"timeline-article",role:"button",tabindex:"0",onClick:k=>V(n.id),onKeyup:F(k=>V(n.id),["enter"])},[s[10]||(s[10]=e("div",{class:"timeline-dot"},null,-1)),e("div",Ge,[e("div",{class:"timeline-thumbnail",style:Y(d(B)(n.cover))},[n.badge?(i(),l("span",et,r(n.badge),1)):f("",!0)],4),e("div",tt,[e("div",st,[s[9]||(s[9]=e("span",{class:"date-icon"},"ðŸ“…",-1)),e("span",null,r(n.date),1),n.updatedDate&&n.updatedDate!==n.date?(i(),l(T,{key:0},[s[8]||(s[8]=e("span",{class:"date-separator"},"Â·",-1)),e("span",at,r(d(g)("article.updated"))+": "+r(n.updatedDate),1)],64)):f("",!0)]),e("h3",{class:"timeline-title",innerHTML:n.highlightedTitle||n.title},null,8,nt),n.description?(i(),l("p",{key:0,class:"timeline-description",innerHTML:n.highlightedDescription||n.description},null,8,ot)):f("",!0)])])],40,Ze))),128))])]))),128))]),N.value.length===0?(i(),l("div",lt,[e("p",null,r(d(g)("search.noResults")),1)])):f("",!0)])),Z(_e,{"current-page":_.value,"onUpdate:currentPage":s[2]||(s[2]=t=>_.value=t),"items-per-page":a.value,"onUpdate:itemsPerPage":s[3]||(s[3]=t=>a.value=t),"total-pages":z.value,"total-items":A.value.length,"items-per-page-options":[5,10,20,50]},null,8,["current-page","items-per-page","total-pages","total-items"])])])]))}}),mt=q(it,[["__scopeId","data-v-8d9e2df7"]]);export{mt as default};
