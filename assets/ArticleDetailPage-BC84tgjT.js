import{c as T,r as K,d as B,u as M,a as b,b as a,m as E,t as u,e as g,F as q,i as _,n as P,o as U,w as O,f as W,h as Y,j as R,p as ee,q as V,s as z,v as j,l as te,A as F,g as oe,k as re}from"./vue-vendor-DU-QEUjR.js";import{_ as L,u as Q,g as ne,a as I}from"./index-SFWPJN_0.js";import{r as ae,g as N,a as se,M as ce,i as le}from"./markdown-vendor-BDlm1NQN.js";import{H as G}from"./highlight-vendor-2JJYcUgK.js";import{b8 as J,b9 as ie}from"./math-vendor-Bk-2vOK0.js";import{g as de}from"./coverStyle-BhxAb7xK.js";var ue=ae();const me=N(ue),$=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var pe=se();const he=N(pe),fe=e=>e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"),A=new ce({html:!0,linkify:!0,typographer:!0,breaks:!0,highlight:function(e,o){if(o==="flowchart"||o==="flow")return'<div class="flowchart-container"><pre class="flowchart" id="'+("flowchart-"+Math.random().toString(36).substr(2,9))+'">'+$(e)+"</pre></div>";if(o==="mermaid"||o==="sequenceDiagram"||o==="classDiagram"||o==="stateDiagram"||o==="erDiagram"||o==="journey"||o==="gantt"||o==="pie"||o==="requirement"||o==="gitgraph"||o==="mindmap"||o==="timeline")return'<div class="mermaid-container"><pre class="mermaid" id="'+("mermaid-"+Math.random().toString(36).substr(2,9))+'">'+$(e)+"</pre></div>";if(o&&G.getLanguage(o))try{return'<pre class="hljs"><code class="language-'+$(o)+'">'+G.highlight(e,{language:o}).value+"</code></pre>"}catch{}return'<pre class="hljs"><code>'+$(e)+"</code></pre>"}});A.use(le);A.use(me);A.use(he,{enabled:!0,label:!0,labelAfter:!0});const X=e=>{if(!e||!Array.isArray(e))return"";let o="";for(const r of e)r?.type==="text"&&r.content||r?.type==="code_inline"&&r.content?o+=r.content:r?.children&&(o+=X(r.children));return o};A.use(function(e){const o=e.renderer.rules.heading_open||function(r,i,f,s,d){return d.renderToken(r,i,f)};e.renderer.rules.heading_open=function(r,i,f,s,d){const C=r[i];if(!C)return o(r,i,f,s,d);const m=parseInt(C.tag.slice(1));let n="",t=i+1;for(;t<r.length&&r[t]?.type!=="heading_close";){const h=r[t];if(h?.type==="inline"){h.children?n=X(h.children):n=h.content||"";break}t++}const c=fe(n),p=s.headingCount||{},l=p[c]||0;p[c]=l+1;const v=l?`${c}-${l}`:c;return s.toc||(s.toc=[]),s.toc.push({id:v,text:n,level:m}),C.attrSet("id",v),o(r,i,f,s,d)}});const ge=e=>{const o={toc:[],headingCount:{}};return{html:A.render(e,o),toc:o.toc||[]}},ve=e=>T(()=>ge(e.value||"")),Ce=(e="article-comments")=>{const o=K({}),r=()=>{try{const d=localStorage.getItem(e);o.value=d?JSON.parse(d):{}}catch{o.value={}}},i=()=>{localStorage.setItem(e,JSON.stringify(o.value))};return{commentsMap:o,loadComments:r,getComments:d=>o.value[d]??[],addComment:(d,C)=>{const m=C.content.trim();if(!m)return;const n=C.author?.trim()||"匿名",t=o.value[d]??[],c={id:Date.now(),author:n,content:m,createdAt:new Date().toISOString()};return o.value={...o.value,[d]:[...t,c]},i(),c}}},ye={class:"hero detail-hero"},be={class:"header-actions"},_e={key:0,class:"title-area"},ke={key:0,class:"badge"},we={class:"meta"},xe={key:1,class:"title-area"},Se={class:"meta"},Te=B({__name:"ArticleHeader",props:{article:{}},emits:["goBack","edit"],setup(e,{emit:o}){const r=o,{t:i}=M();return(f,s)=>(_(),b("section",ye,[a("div",be,[a("button",{class:"back-btn",type:"button",onClick:s[0]||(s[0]=d=>r("goBack"))},"← "+u(g(i)("article.back")),1),e.article?(_(),b("button",{key:0,class:"edit-btn",type:"button",onClick:s[1]||(s[1]=d=>r("edit"))},"✎ "+u(g(i)("article.edit")),1)):E("",!0)]),e.article?(_(),b("div",_e,[e.article.badge?(_(),b("span",ke,u(e.article.badge),1)):E("",!0),a("h1",null,u(e.article.title),1),a("p",we,[a("span",null,u(g(i)("article.created"))+": "+u(e.article.date),1),e.article.updatedDate?(_(),b(q,{key:0},[s[2]||(s[2]=a("span",{class:"dot"},"·",-1)),a("span",null,u(g(i)("article.updated"))+": "+u(e.article.updatedDate),1)],64)):E("",!0),s[3]||(s[3]=a("span",{class:"dot"},"·",-1)),a("span",null,u(e.article.platform),1),s[4]||(s[4]=a("span",{class:"dot"},"·",-1)),a("span",null,u(e.article.tag),1)])])):(_(),b("div",xe,[a("h1",null,u(g(i)("article.notFound")),1),a("p",Se,u(g(i)("article.notFoundDesc")),1)]))]))}}),Ee=L(Te,[["__scopeId","data-v-e5ee6f86"]]),$e=(e,o)=>{const i=o||(n=>({copy:"复制",copied:"已复制!",copyFailed:"复制失败",copyCode:"复制代码"})[n]||n),f=n=>{const t=n.textContent;n.textContent=i("copied"),n.classList.add("copied"),setTimeout(()=>{n.textContent=t,n.classList.remove("copied")},2e3)},s=n=>{const t=n.textContent;n.textContent=i("copyFailed"),n.classList.add("error"),setTimeout(()=>{n.textContent=t,n.classList.remove("error")},2e3)},d=async(n,t)=>{if(!navigator.clipboard||!navigator.clipboard.writeText){console.error("Clipboard API 不可用"),s(t);return}try{await navigator.clipboard.writeText(n),f(t)}catch(c){console.error("复制失败:",c),s(t)}},C=n=>{const t=document.createElement("button");return t.className="copy-code-btn",t.textContent=i("copy"),t.type="button",t.setAttribute("aria-label",i("copyCode")),t.addEventListener("click",()=>{d(n,t)}),t};return{addCopyButtons:()=>{P(()=>{if(!e.value)return;e.value.querySelectorAll("pre.hljs").forEach(t=>{if(t.querySelector(".copy-code-btn"))return;const c=t.querySelector("code");if(!c)return;const p=c.textContent||c.innerText||"",l=C(p);t.appendChild(l)})})}}},Be=e=>{let o=!1,r="default";const i=()=>document.documentElement.classList.contains("dark")?"dark":"default",f=(t=!1)=>{const c=i();(t||!o||r!==c)&&(J.initialize({startOnLoad:!1,theme:c,securityLevel:"loose",themeVariables:c==="dark"?{primaryColor:"#2a2a2a",primaryTextColor:"#e0e0e0",primaryBorderColor:"#e0e0e0",lineColor:"#e0e0e0",secondaryColor:"#1a1a1a",tertiaryColor:"#333",background:"#1e1e1e",mainBkg:"#2a2a2a",secondBkg:"#1a1a1a",textColor:"#e0e0e0",border1:"#e0e0e0",border2:"#9ca3af",noteBkgColor:"#2a2a2a",noteTextColor:"#e0e0e0",noteBorderColor:"#e0e0e0",actorBorder:"#e0e0e0",actorBkg:"#2a2a2a",actorTextColor:"#e0e0e0",actorLineColor:"#e0e0e0",labelBoxBkgColor:"#2a2a2a",labelBoxBorderColor:"#e0e0e0",labelTextColor:"#e0e0e0",loopTextColor:"#e0e0e0",activationBorderColor:"#e0e0e0",activationBkgColor:"#1a1a1a",sequenceNumberColor:"#e0e0e0",sectionBkgColor:"#2a2a2a",altBkgColor:"#1a1a1a",clusterBkg:"#2a2a2a",clusterBorder:"#e0e0e0",defaultLinkColor:"#e0e0e0",titleColor:"#e0e0e0",edgeLabelBackground:"#2a2a2a",compositeBackground:"#2a2a2a",compositeTitleBackground:"#1a1a1a",compositeBorder:"#e0e0e0",stateLabelColor:"#e0e0e0",stateBkg:"#2a2a2a",labelBorderColor:"#e0e0e0",errorBkgColor:"#4a1a1a",errorTextColor:"#ff6b6b"}:void 0}),o=!0,r=c)},s=new WeakMap,d=(t,c=!1)=>{const p=t.id||"mermaid-"+Math.random().toString(36).substr(2,9),l=t.parentElement?.classList.contains("mermaid-container")?t.parentElement:null;let v="";if(v=t.textContent||"",!v.trim()&&c&&l&&s.has(l)&&(v=s.get(l)||""),v.trim()&&l&&!s.has(l)&&s.set(l,v),!v.trim()||t.classList.contains("mermaid-rendered")&&!c)return;t.classList.add("mermaid-rendered");const h=p+"-svg";J.render(h,v).then(y=>{const k=t.parentElement;k&&k.classList.contains("mermaid-container")?k.innerHTML=y.svg:t.innerHTML=y.svg}).catch(y=>{console.error("Mermaid 渲染失败:",y),C(t,v)})},C=(t,c)=>{const p=t.parentElement;p&&p.classList.contains("mermaid-container")&&(p.innerHTML='<pre class="mermaid-error">'+$(c)+"</pre>")},m=(t=!1)=>{P(()=>{if(!e.value)return;const c=i();t||r!==c?f(!0):f();const p=".mermaid-container",l=e.value.querySelectorAll(p);t&&l.forEach(h=>{if(h.querySelector("svg")&&s.has(h)){const k=s.get(h)||"",x="mermaid-"+Math.random().toString(36).substr(2,9);k&&(h.innerHTML=`<pre class="mermaid" id="${x}">${k}</pre>`)}}),setTimeout(()=>{if(!e.value)return;e.value.querySelectorAll(p).forEach(x=>{const S=x.querySelector("pre.mermaid");S&&d(S,t)});const y=t?"pre.mermaid":"pre.mermaid:not(.mermaid-rendered)";e.value.querySelectorAll(y).forEach(x=>{x.closest(".mermaid-container")||d(x,t)})},t?50:0)})};return{initMermaid:m,rerenderMermaid:()=>{m(!0)}}};var Me=ie();const Le=N(Me),Ae=e=>{const o=new WeakMap,r=()=>{const n=document.documentElement.classList.contains("dark");return{textColor:n?"#e0e0e0":"#000000",lineColor:n?"#e0e0e0":"#000000",fillColor:n?"#2a2a2a":"#ffffff",isDark:n}},i=()=>{const{textColor:n,lineColor:t,fillColor:c,isDark:p}=r();return{"line-width":2,"line-length":50,"text-margin":10,"font-size":14,"font-color":n,"line-color":t,"element-color":n,fill:c,"yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,flowstate:{past:{fill:p?"#444444":"#CCCCCC","font-size":12},current:{fill:p?"#4a4a00":"yellow","font-color":p?"#ff6b6b":"red","font-weight":"bold"},future:{fill:p?"#666600":"#FFFF99"},request:{fill:p?"#003366":"blue"},invalid:{fill:p?"#222222":"#444444"},approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}}},f=n=>{const t=document.createElement("div");return t.className="flowchart-svg-container",t.id=n+"-svg",t},s=(n,t=!1)=>{const c=n.id||"flowchart-"+Math.random().toString(36).substr(2,9),p=n.parentElement?.classList.contains("flowchart-container")?n.parentElement:null;let l="";if(l=n.textContent||"",!l.trim()&&t&&p&&o.has(p)&&(l=o.get(p)||""),l.trim()&&p&&!o.has(p)&&o.set(p,l),!!l.trim()&&!(n.classList.contains("flowchart-rendered")&&!t)){n.classList.add("flowchart-rendered");try{const v=Le.parse(l),h=f(c),y=n.parentElement;if(y&&y.classList.contains("flowchart-container")){y.innerHTML="",y.appendChild(h);const k=i();v.drawSVG(c+"-svg",k)}}catch(v){console.error("Flowchart 渲染失败:",v),d(n,l)}}},d=(n,t)=>{const c=n.parentElement;c&&c.classList.contains("flowchart-container")&&(c.innerHTML='<pre class="flowchart-error">'+$(t)+"</pre>")},C=(n=!1)=>{P(()=>{if(!e.value)return;const c=e.value.querySelectorAll(".flowchart-container");n&&c.forEach(l=>{if(l.querySelector(".flowchart-svg-container")&&o.has(l)){const h=o.get(l)||"",y="flowchart-"+Math.random().toString(36).substr(2,9);h&&(l.innerHTML=`<pre class="flowchart" id="${y}">${h}</pre>`)}}),setTimeout(()=>{if(!e.value)return;e.value.querySelectorAll(".flowchart-container").forEach(h=>{const y=h.querySelector("pre.flowchart");y&&s(y,n)})},n?50:0)})};return{initFlowchart:C,rerenderFlowchart:()=>{C(!0)}}},De={class:"article-card detail-card"},Fe={key:0,class:"badge"},Ie={class:"card-body"},qe={class:"tag-row"},Pe={class:"tag"},He={class:"title"},Ne={class:"description"},Oe={class:"meta"},Ve={class:"nav-row"},ze=["disabled"],je=["disabled"],Ge=["innerHTML"],Je=B({__name:"ArticleContent",props:{article:{},htmlContent:{},prevArticle:{},nextArticle:{}},emits:["goPrev","goNext"],setup(e,{emit:o}){const{t:r}=M(),i=Q(),f=e,s=o,d=K(),{addCopyButtons:C}=$e(d,v=>({copy:r("code.copy"),copied:r("code.copied"),copyFailed:r("code.copyFailed"),copyCode:r("code.copyCode")})[v]||v),{initMermaid:m,rerenderMermaid:n}=Be(d),{initFlowchart:t,rerenderFlowchart:c}=Ae(d),p=()=>{C(),m(),t(),l()},l=()=>{P(()=>{if(!d.value)return;const v=d.value.querySelectorAll("table"),h=i.isDark||document.documentElement.classList.contains("dark"),k=getComputedStyle(document.documentElement).getPropertyValue("--border").trim()||"#e5e7eb",S=h?"#d1d5db":k;v.forEach(D=>{D.style.setProperty("border",`2px solid ${S}`,"important"),D.querySelectorAll("th, td").forEach(Z=>{Z.style.setProperty("border",`1px solid ${S}`,"important")})})})};return U(()=>{p(),new MutationObserver(()=>{l(),setTimeout(()=>{n(),c()},100)}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),setTimeout(()=>{l()},100)}),O(()=>f.htmlContent,()=>{p(),setTimeout(()=>{l()},100)}),O(()=>i.isDark,()=>{setTimeout(()=>{l(),n(),c()},100)}),(v,h)=>(_(),b("article",De,[a("div",{class:"card-cover",style:W(g(de)(e.article.cover))},[e.article.badge?(_(),b("span",Fe,u(e.article.badge),1)):E("",!0)],4),a("div",Ie,[a("div",qe,[a("span",Pe,u(e.article.tag),1)]),a("h2",He,u(e.article.title),1),a("p",Ne,u(e.article.description),1),a("div",Oe,[a("span",null,u(g(r)("article.created"))+": "+u(e.article.date),1),e.article.updatedDate?(_(),b(q,{key:0},[h[2]||(h[2]=a("span",{class:"dot"},"·",-1)),a("span",null,u(g(r)("article.updated"))+": "+u(e.article.updatedDate),1)],64)):E("",!0),h[3]||(h[3]=a("span",{class:"dot"},"·",-1)),a("span",null,u(e.article.platform),1),h[4]||(h[4]=a("span",{class:"dot"},"·",-1)),a("span",null,u(e.article.tag),1)]),a("div",Ve,[a("button",{class:"ghost-btn",type:"button",disabled:!e.prevArticle,onClick:h[0]||(h[0]=y=>s("goPrev"))}," ← "+u(g(r)("article.prevArticle")),9,ze),a("button",{class:"ghost-btn",type:"button",disabled:!e.nextArticle,onClick:h[1]||(h[1]=y=>s("goNext"))},u(g(r)("article.nextArticle"))+" → ",9,je)]),a("div",{ref_key:"contentBlockRef",ref:d,class:"content-block",innerHTML:e.htmlContent},null,8,Ge)])]))}}),Ke=L(Je,[["__scopeId","data-v-b88dd746"]]),Ue={key:0,class:"toc"},We={class:"toc-title"},Ye=["href","onClick"],Qe=B({__name:"ArticleTOC",props:{toc:{}},setup(e){const{t:o}=M(),r=(i,f)=>{i.preventDefault();const s=document.getElementById(f);if(s){const m=s.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:m,behavior:"smooth"}),history.replaceState(null,"",`#${f}`)}};return(i,f)=>e.toc.length?(_(),b("aside",Ue,[a("div",We,u(g(o)("toc.title")),1),a("nav",null,[(_(!0),b(q,null,Y(e.toc,s=>(_(),b("a",{key:s.id,class:"toc-item",style:W({paddingLeft:`${(s.level-1)*12}px`}),href:`#${s.id}`,onClick:d=>r(d,s.id)},u(s.text),13,Ye))),128))])])):E("",!0)}}),Xe=L(Qe,[["__scopeId","data-v-298d8e57"]]),Ze={class:"comments"},Re={class:"comments__header"},et={class:"comments__count"},tt={key:0,class:"comments__list"},ot={class:"comment__header"},rt={class:"comment__author"},nt={class:"comment__time"},at={class:"comment__content"},st={key:1,class:"comments__empty"},ct={class:"form-row"},lt=["placeholder"],it={class:"form-row"},dt=["placeholder"],ut={class:"submit-btn",type:"submit"},mt=B({__name:"CommentSection",props:{comments:{},articleId:{}},emits:["submit"],setup(e,{emit:o}){const{t:r}=M(),i=o,f=R({author:"",content:""}),s=()=>{const d=f.content.trim();d&&(i("submit",{author:f.author,content:d}),f.author="",f.content="")};return(d,C)=>(_(),b("section",Ze,[a("header",Re,[a("h3",null,u(g(r)("comments.title")),1),a("span",et,u(g(r)("comments.count",{count:e.comments.length})),1)]),e.comments.length?(_(),b("ul",tt,[(_(!0),b(q,null,Y(e.comments,m=>(_(),b("li",{key:m.id,class:"comment"},[a("div",ot,[a("span",rt,u(m.author),1),a("span",nt,u(new Date(m.createdAt).toLocaleString()),1)]),a("p",at,u(m.content),1)]))),128))])):(_(),b("p",st,u(g(r)("comments.empty")),1)),a("form",{class:"comment-form",onSubmit:ee(s,["prevent"])},[a("div",ct,[a("label",null,[V(u(g(r)("comments.authorLabel"))+" ",1),z(a("input",{"onUpdate:modelValue":C[0]||(C[0]=m=>f.author=m),placeholder:g(r)("comments.authorPlaceholder")},null,8,lt),[[j,f.author]])])]),a("div",it,[a("label",null,[V(u(g(r)("comments.contentLabel"))+" ",1),z(a("textarea",{"onUpdate:modelValue":C[1]||(C[1]=m=>f.content=m),rows:"4",required:"",placeholder:g(r)("comments.contentPlaceholder")},null,8,dt),[[j,f.content]])])]),a("button",ut,u(g(r)("comments.submit")),1)],32)]))}}),pt=L(mt,[["__scopeId","data-v-a9391980"]]),ht={class:"layout detail-layout"},ft=["aria-label"],gt={class:"exit-text"},vt={class:"article-area"},Ct={class:"content-wrapper"},yt={key:1,class:"article-card detail-card empty-state"},bt={class:"card-body"},_t={class:"title"},kt={class:"description"},wt=B({__name:"ArticleDetailPage",setup(e){const o=te(),r=re(),{t:i}=M(),f=Q(),{loadComments:s,getComments:d,addComment:C}=Ce(),m=T(()=>{const w=o.params.id;return w?ne(w)??null:null}),n=T(()=>m.value?.content??""),t=ve(n),c=T(()=>m.value?I.findIndex(w=>w.id===m.value?.id):-1),p=T(()=>c.value>0?I[c.value-1]:null),l=T(()=>c.value>=0&&c.value<I.length-1?I[c.value+1]:null),v=T(()=>{const w=m.value?.id;return w?d(w):[]}),h=()=>{r.back()},y=()=>{p.value&&r.push({name:"articleDetail",params:{id:p.value.id}})},k=()=>{l.value&&r.push({name:"articleDetail",params:{id:l.value.id}})},x=()=>{m.value&&r.push({name:"articleEdit",params:{id:m.value.id}})},S=w=>{m.value&&C(m.value.id,w)},D=()=>{f.toggleReadingMode()};return U(()=>{s()}),(w,H)=>(_(),b("main",ht,[g(f).readingMode?(_(),b("button",{key:0,class:"exit-reading-mode-btn",type:"button",onClick:D,"aria-label":g(i)("article.exitReadingMode")},[H[0]||(H[0]=a("span",{class:"exit-icon"},"✕",-1)),a("span",gt,u(g(i)("article.exitReadingMode")),1)],8,ft)):E("",!0),F(Ee,{article:m.value,onGoBack:h,onEdit:x},null,8,["article"]),a("section",vt,[m.value?(_(),b("div",{key:0,class:oe(["detail-grid",`layout-${g(f).articleLayout}`])},[a("div",Ct,[F(Ke,{article:m.value,"html-content":g(t).html,"prev-article":p.value??null,"next-article":l.value??null,onGoPrev:y,onGoNext:k},null,8,["article","html-content","prev-article","next-article"]),F(pt,{comments:v.value,"article-id":m.value.id,onSubmit:S},null,8,["comments","article-id"])]),F(Xe,{toc:g(t).toc},null,8,["toc"])],2)):(_(),b("article",yt,[a("div",bt,[a("h2",_t,u(g(i)("article.notFound")),1),a("p",kt,u(g(i)("article.notFoundDesc")),1)])]))])]))}}),Lt=L(wt,[["__scopeId","data-v-52f4068d"]]);export{Lt as default};
