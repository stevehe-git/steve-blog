import{c as w,r as V,d as k,u as $,a as g,b as r,j as F,t as u,e as v,i as _,n as B,o as j,w as P,f as R,F as G,h as J,x as Q,z as W,p as q,l as H,v as N,y as X,k as L,q as Z}from"./vue-vendor-D3XWct0c.js";import{u as tt,g as et,a as M}from"./index-0TcXpke1.js";import{r as ot,g as D,a as nt,M as st,i as rt}from"./markdown-vendor-BDlm1NQN.js";import{H as O}from"./highlight-vendor-2JJYcUgK.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b8 as z,b9 as ct}from"./math-vendor-BhqHCc24.js";import{g as at}from"./coverStyle-BhxAb7xK.js";var lt=ot();const it=D(lt),x=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var dt=nt();const ut=D(dt),mt=t=>t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"),S=new st({html:!0,linkify:!0,typographer:!0,breaks:!0,highlight:function(t,e){if(e==="flowchart"||e==="flow")return'<div class="flowchart-container"><pre class="flowchart" id="'+("flowchart-"+Math.random().toString(36).substr(2,9))+'">'+x(t)+"</pre></div>";if(e==="mermaid"||e==="sequenceDiagram"||e==="classDiagram"||e==="stateDiagram"||e==="erDiagram"||e==="journey"||e==="gantt"||e==="pie"||e==="requirement"||e==="gitgraph"||e==="mindmap"||e==="timeline")return'<div class="mermaid-container"><pre class="mermaid" id="'+("mermaid-"+Math.random().toString(36).substr(2,9))+'">'+x(t)+"</pre></div>";if(e&&O.getLanguage(e))try{return'<pre class="hljs"><code class="language-'+x(e)+'">'+O.highlight(t,{language:e}).value+"</code></pre>"}catch{}return'<pre class="hljs"><code>'+x(t)+"</code></pre>"}});S.use(rt);S.use(it);S.use(ut,{enabled:!0,label:!0,labelAfter:!0});const K=t=>{if(!t||!Array.isArray(t))return"";let e="";for(const o of t)o?.type==="text"&&o.content||o?.type==="code_inline"&&o.content?e+=o.content:o?.children&&(e+=K(o.children));return e};S.use(function(t){const e=t.renderer.rules.heading_open||function(o,d,m,i,c){return c.renderToken(o,d,m)};t.renderer.rules.heading_open=function(o,d,m,i,c){const n=o[d];if(!n)return e(o,d,m,i,c);const l=parseInt(n.tag.slice(1));let a="",s=d+1;for(;s<o.length&&o[s]?.type!=="heading_close";){const C=o[s];if(C?.type==="inline"){C.children?a=K(C.children):a=C.content||"";break}s++}const h=mt(a),f=i.headingCount||{},p=f[h]||0;f[h]=p+1;const b=p?`${h}-${p}`:h;return i.toc||(i.toc=[]),i.toc.push({id:b,text:a,level:l}),n.attrSet("id",b),e(o,d,m,i,c)}});const ht=t=>{const e={toc:[],headingCount:{}};return{html:S.render(t,e),toc:e.toc||[]}},pt=t=>w(()=>ht(t.value||"")),ft=(t="article-comments")=>{const e=V({}),o=()=>{try{const c=localStorage.getItem(t);e.value=c?JSON.parse(c):{}}catch{e.value={}}},d=()=>{localStorage.setItem(t,JSON.stringify(e.value))};return{commentsMap:e,loadComments:o,getComments:c=>e.value[c]??[],addComment:(c,n)=>{const l=n.content.trim();if(!l)return;const a=n.author?.trim()||"匿名",s=e.value[c]??[],h={id:Date.now(),author:a,content:l,createdAt:new Date().toISOString()};return e.value={...e.value,[c]:[...s,h]},d(),h}}},vt={class:"hero detail-hero"},gt={class:"header-actions"},_t={key:0,class:"title-area"},yt={key:0,class:"badge"},Ct={class:"meta"},bt={key:1,class:"title-area"},wt={class:"meta"},xt=k({__name:"ArticleHeader",props:{article:{}},emits:["goBack","edit"],setup(t,{emit:e}){const o=e,{t:d}=$();return(m,i)=>(_(),g("section",vt,[r("div",gt,[r("button",{class:"back-btn",type:"button",onClick:i[0]||(i[0]=c=>o("goBack"))},"← "+u(v(d)("article.back")),1),t.article?(_(),g("button",{key:0,class:"edit-btn",type:"button",onClick:i[1]||(i[1]=c=>o("edit"))},"✎ "+u(v(d)("article.edit")),1)):F("",!0)]),t.article?(_(),g("div",_t,[t.article.badge?(_(),g("span",yt,u(t.article.badge),1)):F("",!0),r("h1",null,u(t.article.title),1),r("p",Ct,[r("span",null,u(t.article.date),1),i[2]||(i[2]=r("span",{class:"dot"},"·",-1)),r("span",null,u(t.article.platform),1),i[3]||(i[3]=r("span",{class:"dot"},"·",-1)),r("span",null,u(t.article.tag),1)])])):(_(),g("div",bt,[r("h1",null,u(v(d)("article.notFound")),1),r("p",wt,u(v(d)("article.notFoundDesc")),1)]))]))}}),kt=E(xt,[["__scopeId","data-v-0f3ff6f9"]]),$t=(t,e)=>{const d=e||(a=>({copy:"复制",copied:"已复制!",copyFailed:"复制失败",copyCode:"复制代码"})[a]||a),m=a=>{const s=a.textContent;a.textContent=d("copied"),a.classList.add("copied"),setTimeout(()=>{a.textContent=s,a.classList.remove("copied")},2e3)},i=a=>{const s=a.textContent;a.textContent=d("copyFailed"),a.classList.add("error"),setTimeout(()=>{a.textContent=s,a.classList.remove("error")},2e3)},c=async(a,s)=>{if(!navigator.clipboard||!navigator.clipboard.writeText){console.error("Clipboard API 不可用"),i(s);return}try{await navigator.clipboard.writeText(a),m(s)}catch(h){console.error("复制失败:",h),i(s)}},n=a=>{const s=document.createElement("button");return s.className="copy-code-btn",s.textContent=d("copy"),s.type="button",s.setAttribute("aria-label",d("copyCode")),s.addEventListener("click",()=>{c(a,s)}),s};return{addCopyButtons:()=>{B(()=>{if(!t.value)return;t.value.querySelectorAll("pre.hljs").forEach(s=>{if(s.querySelector(".copy-code-btn"))return;const h=s.querySelector("code");if(!h)return;const f=h.textContent||h.innerText||"",p=n(f);s.appendChild(p)})})}}},Et=t=>{let e=!1;const o=()=>{e||(z.initialize({startOnLoad:!1,theme:"default",securityLevel:"loose"}),e=!0)},d=c=>{const n=c.id||"mermaid-"+Math.random().toString(36).substr(2,9),l=c.textContent||"";if(!l.trim())return;c.classList.add("mermaid-rendered");const a=n+"-svg";z.render(a,l).then(s=>{const h=c.parentElement;h&&h.classList.contains("mermaid-container")?h.innerHTML=s.svg:c.innerHTML=s.svg}).catch(s=>{console.error("Mermaid 渲染失败:",s),m(c,l)})},m=(c,n)=>{const l=c.parentElement;l&&l.classList.contains("mermaid-container")&&(l.innerHTML='<pre class="mermaid-error">'+x(n)+"</pre>")};return{initMermaid:()=>{B(()=>{if(!t.value)return;o(),t.value.querySelectorAll("pre.mermaid:not(.mermaid-rendered)").forEach(n=>{d(n)})})}}};var St=ct();const Tt=D(St),At=t=>{const e=()=>{const n=document.documentElement.classList.contains("dark");return{textColor:n?"#e0e0e0":"#000000",lineColor:n?"#e0e0e0":"#000000",fillColor:n?"#2a2a2a":"#ffffff",isDark:n}},o=()=>{const{textColor:n,lineColor:l,fillColor:a,isDark:s}=e();return{"line-width":2,"line-length":50,"text-margin":10,"font-size":14,"font-color":n,"line-color":l,"element-color":n,fill:a,"yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,flowstate:{past:{fill:s?"#444444":"#CCCCCC","font-size":12},current:{fill:s?"#4a4a00":"yellow","font-color":s?"#ff6b6b":"red","font-weight":"bold"},future:{fill:s?"#666600":"#FFFF99"},request:{fill:s?"#003366":"blue"},invalid:{fill:s?"#222222":"#444444"},approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}}},d=n=>{const l=document.createElement("div");return l.className="flowchart-svg-container",l.id=n+"-svg",l},m=n=>{const l=n.id||"flowchart-"+Math.random().toString(36).substr(2,9),a=n.textContent||"";if(a.trim()){n.classList.add("flowchart-rendered");try{const s=Tt.parse(a),h=d(l),f=n.parentElement;if(f&&f.classList.contains("flowchart-container")){f.innerHTML="",f.appendChild(h);const p=o();s.drawSVG(l+"-svg",p)}}catch(s){console.error("Flowchart 渲染失败:",s),i(n,a)}}},i=(n,l)=>{const a=n.parentElement;a&&a.classList.contains("flowchart-container")&&(a.innerHTML='<pre class="flowchart-error">'+x(l)+"</pre>")};return{initFlowchart:()=>{B(()=>{if(!t.value)return;t.value.querySelectorAll("pre.flowchart:not(.flowchart-rendered)").forEach(l=>{m(l)})})}}},Lt={class:"article-card detail-card"},Mt={key:0,class:"badge"},Ft={class:"card-body"},Bt={class:"tag-row"},Dt={class:"tag"},It={class:"title"},Pt={class:"description"},qt={class:"meta"},Ht={class:"nav-row"},Nt=["disabled"],Ot=["disabled"],zt=["innerHTML"],Vt=k({__name:"ArticleContent",props:{article:{},htmlContent:{},prevArticle:{},nextArticle:{}},emits:["goPrev","goNext"],setup(t,{emit:e}){const{t:o}=$(),d=tt(),m=t,i=e,c=V(),{addCopyButtons:n}=$t(c,f=>({copy:o("code.copy"),copied:o("code.copied"),copyFailed:o("code.copyFailed"),copyCode:o("code.copyCode")})[f]||f),{initMermaid:l}=Et(c),{initFlowchart:a}=At(c),s=()=>{n(),l(),a(),h()},h=()=>{B(()=>{if(!c.value)return;const f=c.value.querySelectorAll("table"),p=d.isDark||document.documentElement.classList.contains("dark"),C=getComputedStyle(document.documentElement).getPropertyValue("--border").trim()||"#e5e7eb",T=p?"#d1d5db":C;f.forEach(A=>{A.style.setProperty("border",`2px solid ${T}`,"important"),A.querySelectorAll("th, td").forEach(Y=>{Y.style.setProperty("border",`1px solid ${T}`,"important")})})})};return j(()=>{s(),new MutationObserver(()=>{h()}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),setTimeout(()=>{h()},100)}),P(()=>m.htmlContent,()=>{s(),setTimeout(()=>{h()},100)}),P(()=>d.isDark,()=>{setTimeout(()=>{h()},50)}),(f,p)=>(_(),g("article",Lt,[r("div",{class:"card-cover",style:R(v(at)(t.article.cover))},[t.article.badge?(_(),g("span",Mt,u(t.article.badge),1)):F("",!0)],4),r("div",Ft,[r("div",Bt,[r("span",Dt,u(t.article.tag),1)]),r("h2",It,u(t.article.title),1),r("p",Pt,u(t.article.description),1),r("div",qt,[r("span",null,u(t.article.date),1),p[2]||(p[2]=r("span",{class:"dot"},"·",-1)),r("span",null,u(t.article.platform),1),p[3]||(p[3]=r("span",{class:"dot"},"·",-1)),r("span",null,u(t.article.tag),1)]),r("div",Ht,[r("button",{class:"ghost-btn",type:"button",disabled:!t.prevArticle,onClick:p[0]||(p[0]=b=>i("goPrev"))}," ← "+u(v(o)("article.prevArticle")),9,Nt),r("button",{class:"ghost-btn",type:"button",disabled:!t.nextArticle,onClick:p[1]||(p[1]=b=>i("goNext"))},u(v(o)("article.nextArticle"))+" → ",9,Ot)]),r("div",{ref_key:"contentBlockRef",ref:c,class:"content-block",innerHTML:t.htmlContent},null,8,zt)])]))}}),jt=E(Vt,[["__scopeId","data-v-e31eaa36"]]),Rt={key:0,class:"toc"},Gt={class:"toc-title"},Jt=["href","onClick"],Kt=k({__name:"ArticleTOC",props:{toc:{}},setup(t){const{t:e}=$(),o=(d,m)=>{d.preventDefault();const i=document.getElementById(m);if(i){const l=i.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:l,behavior:"smooth"}),history.replaceState(null,"",`#${m}`)}};return(d,m)=>t.toc.length?(_(),g("aside",Rt,[r("div",Gt,u(v(e)("toc.title")),1),r("nav",null,[(_(!0),g(G,null,J(t.toc,i=>(_(),g("a",{key:i.id,class:"toc-item",style:R({paddingLeft:`${(i.level-1)*12}px`}),href:`#${i.id}`,onClick:c=>o(c,i.id)},u(i.text),13,Jt))),128))])])):F("",!0)}}),Ut=E(Kt,[["__scopeId","data-v-298d8e57"]]),Yt={class:"comments"},Qt={class:"comments__header"},Wt={class:"comments__count"},Xt={key:0,class:"comments__list"},Zt={class:"comment__header"},te={class:"comment__author"},ee={class:"comment__time"},oe={class:"comment__content"},ne={key:1,class:"comments__empty"},se={class:"form-row"},re=["placeholder"],ce={class:"form-row"},ae=["placeholder"],le={class:"submit-btn",type:"submit"},ie=k({__name:"CommentSection",props:{comments:{},articleId:{}},emits:["submit"],setup(t,{emit:e}){const{t:o}=$(),d=e,m=Q({author:"",content:""}),i=()=>{const c=m.content.trim();c&&(d("submit",{author:m.author,content:c}),m.author="",m.content="")};return(c,n)=>(_(),g("section",Yt,[r("header",Qt,[r("h3",null,u(v(o)("comments.title")),1),r("span",Wt,u(v(o)("comments.count",{count:t.comments.length})),1)]),t.comments.length?(_(),g("ul",Xt,[(_(!0),g(G,null,J(t.comments,l=>(_(),g("li",{key:l.id,class:"comment"},[r("div",Zt,[r("span",te,u(l.author),1),r("span",ee,u(new Date(l.createdAt).toLocaleString()),1)]),r("p",oe,u(l.content),1)]))),128))])):(_(),g("p",ne,u(v(o)("comments.empty")),1)),r("form",{class:"comment-form",onSubmit:W(i,["prevent"])},[r("div",se,[r("label",null,[q(u(v(o)("comments.authorLabel"))+" ",1),H(r("input",{"onUpdate:modelValue":n[0]||(n[0]=l=>m.author=l),placeholder:v(o)("comments.authorPlaceholder")},null,8,re),[[N,m.author]])])]),r("div",ce,[r("label",null,[q(u(v(o)("comments.contentLabel"))+" ",1),H(r("textarea",{"onUpdate:modelValue":n[1]||(n[1]=l=>m.content=l),rows:"4",required:"",placeholder:v(o)("comments.contentPlaceholder")},null,8,ae),[[N,m.content]])])]),r("button",le,u(v(o)("comments.submit")),1)],32)]))}}),de=E(ie,[["__scopeId","data-v-a9391980"]]),ue={class:"layout detail-layout"},me={class:"article-area"},he={key:0,class:"detail-grid"},pe={class:"content-wrapper"},fe={key:1,class:"article-card detail-card empty-state"},ve={class:"card-body"},ge={class:"title"},_e={class:"description"},ye=k({__name:"ArticleDetailPage",setup(t){const e=X(),o=Z(),{t:d}=$(),{loadComments:m,getComments:i,addComment:c}=ft(),n=w(()=>{const y=e.params.id;return y?et(y)??null:null}),l=w(()=>n.value?.content??""),a=pt(l),s=w(()=>n.value?M.findIndex(y=>y.id===n.value?.id):-1),h=w(()=>s.value>0?M[s.value-1]:null),f=w(()=>s.value>=0&&s.value<M.length-1?M[s.value+1]:null),p=w(()=>{const y=n.value?.id;return y?i(y):[]}),b=()=>{o.back()},C=()=>{h.value&&o.push({name:"articleDetail",params:{id:h.value.id}})},I=()=>{f.value&&o.push({name:"articleDetail",params:{id:f.value.id}})},T=()=>{n.value&&o.push({name:"articleEdit",params:{id:n.value.id}})},A=y=>{n.value&&c(n.value.id,y)};return j(()=>{m()}),(y,U)=>(_(),g("main",ue,[L(kt,{article:n.value,onGoBack:b,onEdit:T},null,8,["article"]),r("section",me,[n.value?(_(),g("div",he,[r("div",pe,[L(jt,{article:n.value,"html-content":v(a).html,"prev-article":h.value??null,"next-article":f.value??null,onGoPrev:C,onGoNext:I},null,8,["article","html-content","prev-article","next-article"]),L(de,{comments:p.value,"article-id":n.value.id,onSubmit:A},null,8,["comments","article-id"])]),L(Ut,{toc:v(a).toc},null,8,["toc"])])):(_(),g("article",fe,[r("div",ve,[r("h2",ge,u(v(d)("article.notFound")),1),r("p",_e,u(v(d)("article.notFoundDesc")),1)])]))])]))}}),Te=E(ye,[["__scopeId","data-v-266627e9"]]);export{Te as default};
