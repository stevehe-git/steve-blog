import{c as T,r as G,d as B,u as L,a as b,b as a,m as $,t as d,e as v,F as I,i as _,n as q,o as J,w as H,f as K,h as U,j as Z,p as R,q as N,s as O,v as V,l as ee,A as D,g as te,k as oe}from"./vue-vendor-DU-QEUjR.js";import{_ as M,u as W,g as re,a as F}from"./index-CDeJfRXt.js";import{r as ne,g as P,a as ae,M as se,i as ce}from"./markdown-vendor-BDlm1NQN.js";import{H as z}from"./highlight-vendor-2JJYcUgK.js";import{b8 as j,b9 as le}from"./math-vendor-2lAd_3xY.js";import{g as ie}from"./coverStyle-BhxAb7xK.js";var de=ne();const ue=P(de),E=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var me=ae();const pe=P(me),he=e=>e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"),A=new se({html:!0,linkify:!0,typographer:!0,breaks:!0,highlight:function(e,o){if(o==="flowchart"||o==="flow")return'<div class="flowchart-container"><pre class="flowchart" id="'+("flowchart-"+Math.random().toString(36).substr(2,9))+'">'+E(e)+"</pre></div>";if(o==="mermaid"||o==="sequenceDiagram"||o==="classDiagram"||o==="stateDiagram"||o==="erDiagram"||o==="journey"||o==="gantt"||o==="pie"||o==="requirement"||o==="gitgraph"||o==="mindmap"||o==="timeline")return'<div class="mermaid-container"><pre class="mermaid" id="'+("mermaid-"+Math.random().toString(36).substr(2,9))+'">'+E(e)+"</pre></div>";if(o&&z.getLanguage(o))try{return'<pre class="hljs"><code class="language-'+E(o)+'">'+z.highlight(e,{language:o}).value+"</code></pre>"}catch{}return'<pre class="hljs"><code>'+E(e)+"</code></pre>"}});A.use(ce);A.use(ue);A.use(pe,{enabled:!0,label:!0,labelAfter:!0});const Y=e=>{if(!e||!Array.isArray(e))return"";let o="";for(const r of e)r?.type==="text"&&r.content||r?.type==="code_inline"&&r.content?o+=r.content:r?.children&&(o+=Y(r.children));return o};A.use(function(e){const o=e.renderer.rules.heading_open||function(r,u,f,s,i){return i.renderToken(r,u,f)};e.renderer.rules.heading_open=function(r,u,f,s,i){const C=r[u];if(!C)return o(r,u,f,s,i);const m=parseInt(C.tag.slice(1));let n="",t=u+1;for(;t<r.length&&r[t]?.type!=="heading_close";){const h=r[t];if(h?.type==="inline"){h.children?n=Y(h.children):n=h.content||"";break}t++}const c=he(n),p=s.headingCount||{},l=p[c]||0;p[c]=l+1;const g=l?`${c}-${l}`:c;return s.toc||(s.toc=[]),s.toc.push({id:g,text:n,level:m}),C.attrSet("id",g),o(r,u,f,s,i)}});const fe=e=>{const o={toc:[],headingCount:{}};return{html:A.render(e,o),toc:o.toc||[]}},ge=e=>T(()=>fe(e.value||"")),ve=(e="article-comments")=>{const o=G({}),r=()=>{try{const i=localStorage.getItem(e);o.value=i?JSON.parse(i):{}}catch{o.value={}}},u=()=>{localStorage.setItem(e,JSON.stringify(o.value))};return{commentsMap:o,loadComments:r,getComments:i=>o.value[i]??[],addComment:(i,C)=>{const m=C.content.trim();if(!m)return;const n=C.author?.trim()||"匿名",t=o.value[i]??[],c={id:Date.now(),author:n,content:m,createdAt:new Date().toISOString()};return o.value={...o.value,[i]:[...t,c]},u(),c}}},Ce={class:"hero detail-hero"},ye={class:"header-actions"},be={key:0,class:"title-area"},_e={key:0,class:"badge"},ke={class:"meta"},we={key:1,class:"title-area"},xe={class:"meta"},Se=B({__name:"ArticleHeader",props:{article:{}},emits:["goBack","edit"],setup(e,{emit:o}){const r=o,{t:u}=L();return(f,s)=>(_(),b("section",Ce,[a("div",ye,[a("button",{class:"back-btn",type:"button",onClick:s[0]||(s[0]=i=>r("goBack"))},"← "+d(v(u)("article.back")),1),e.article?(_(),b("button",{key:0,class:"edit-btn",type:"button",onClick:s[1]||(s[1]=i=>r("edit"))},"✎ "+d(v(u)("article.edit")),1)):$("",!0)]),e.article?(_(),b("div",be,[e.article.badge?(_(),b("span",_e,d(e.article.badge),1)):$("",!0),a("h1",null,d(e.article.title),1),a("p",ke,[a("span",null,d(v(u)("article.created"))+": "+d(e.article.date),1),e.article.updatedDate?(_(),b(I,{key:0},[s[2]||(s[2]=a("span",{class:"dot"},"·",-1)),a("span",null,d(v(u)("article.updated"))+": "+d(e.article.updatedDate),1)],64)):$("",!0),s[3]||(s[3]=a("span",{class:"dot"},"·",-1)),a("span",null,d(e.article.platform),1),s[4]||(s[4]=a("span",{class:"dot"},"·",-1)),a("span",null,d(e.article.tag),1)])])):(_(),b("div",we,[a("h1",null,d(v(u)("article.notFound")),1),a("p",xe,d(v(u)("article.notFoundDesc")),1)]))]))}}),Te=M(Se,[["__scopeId","data-v-e5ee6f86"]]),Ee=(e,o)=>{const u=o||(n=>({copy:"复制",copied:"已复制!",copyFailed:"复制失败",copyCode:"复制代码"})[n]||n),f=n=>{const t=n.textContent;n.textContent=u("copied"),n.classList.add("copied"),setTimeout(()=>{n.textContent=t,n.classList.remove("copied")},2e3)},s=n=>{const t=n.textContent;n.textContent=u("copyFailed"),n.classList.add("error"),setTimeout(()=>{n.textContent=t,n.classList.remove("error")},2e3)},i=async(n,t)=>{if(!navigator.clipboard||!navigator.clipboard.writeText){console.error("Clipboard API 不可用"),s(t);return}try{await navigator.clipboard.writeText(n),f(t)}catch(c){console.error("复制失败:",c),s(t)}},C=n=>{const t=document.createElement("button");return t.className="copy-code-btn",t.textContent=u("copy"),t.type="button",t.setAttribute("aria-label",u("copyCode")),t.addEventListener("click",()=>{i(n,t)}),t};return{addCopyButtons:()=>{q(()=>{if(!e.value)return;e.value.querySelectorAll("pre.hljs").forEach(t=>{if(t.querySelector(".copy-code-btn"))return;const c=t.querySelector("code");if(!c)return;const p=c.textContent||c.innerText||"",l=C(p);t.appendChild(l)})})}}},$e=e=>{let o=!1,r="default";const u=()=>document.documentElement.classList.contains("dark")?"dark":"default",f=(t=!1)=>{const c=u();(t||!o||r!==c)&&(j.initialize({startOnLoad:!1,theme:c,securityLevel:"loose",themeVariables:c==="dark"?{primaryColor:"#2a2a2a",primaryTextColor:"#e0e0e0",primaryBorderColor:"#e0e0e0",lineColor:"#e0e0e0",secondaryColor:"#1a1a1a",tertiaryColor:"#333",background:"#1e1e1e",mainBkg:"#2a2a2a",secondBkg:"#1a1a1a",textColor:"#e0e0e0",border1:"#e0e0e0",border2:"#9ca3af",noteBkgColor:"#2a2a2a",noteTextColor:"#e0e0e0",noteBorderColor:"#e0e0e0",actorBorder:"#e0e0e0",actorBkg:"#2a2a2a",actorTextColor:"#e0e0e0",actorLineColor:"#e0e0e0",labelBoxBkgColor:"#2a2a2a",labelBoxBorderColor:"#e0e0e0",labelTextColor:"#e0e0e0",loopTextColor:"#e0e0e0",activationBorderColor:"#e0e0e0",activationBkgColor:"#1a1a1a",sequenceNumberColor:"#e0e0e0",sectionBkgColor:"#2a2a2a",altBkgColor:"#1a1a1a",clusterBkg:"#2a2a2a",clusterBorder:"#e0e0e0",defaultLinkColor:"#e0e0e0",titleColor:"#e0e0e0",edgeLabelBackground:"#2a2a2a",compositeBackground:"#2a2a2a",compositeTitleBackground:"#1a1a1a",compositeBorder:"#e0e0e0",stateLabelColor:"#e0e0e0",stateBkg:"#2a2a2a",labelBorderColor:"#e0e0e0",errorBkgColor:"#4a1a1a",errorTextColor:"#ff6b6b"}:void 0}),o=!0,r=c)},s=new WeakMap,i=(t,c=!1)=>{const p=t.id||"mermaid-"+Math.random().toString(36).substr(2,9),l=t.parentElement?.classList.contains("mermaid-container")?t.parentElement:null;let g="";if(g=t.textContent||"",!g.trim()&&c&&l&&s.has(l)&&(g=s.get(l)||""),g.trim()&&l&&!s.has(l)&&s.set(l,g),!g.trim()||t.classList.contains("mermaid-rendered")&&!c)return;t.classList.add("mermaid-rendered");const h=p+"-svg";j.render(h,g).then(y=>{const k=t.parentElement;k&&k.classList.contains("mermaid-container")?k.innerHTML=y.svg:t.innerHTML=y.svg}).catch(y=>{console.error("Mermaid 渲染失败:",y),C(t,g)})},C=(t,c)=>{const p=t.parentElement;p&&p.classList.contains("mermaid-container")&&(p.innerHTML='<pre class="mermaid-error">'+E(c)+"</pre>")},m=(t=!1)=>{q(()=>{if(!e.value)return;const c=u();t||r!==c?f(!0):f();const p=".mermaid-container",l=e.value.querySelectorAll(p);t&&l.forEach(h=>{if(h.querySelector("svg")&&s.has(h)){const k=s.get(h)||"",x="mermaid-"+Math.random().toString(36).substr(2,9);k&&(h.innerHTML=`<pre class="mermaid" id="${x}">${k}</pre>`)}}),setTimeout(()=>{if(!e.value)return;e.value.querySelectorAll(p).forEach(x=>{const S=x.querySelector("pre.mermaid");S&&i(S,t)});const y=t?"pre.mermaid":"pre.mermaid:not(.mermaid-rendered)";e.value.querySelectorAll(y).forEach(x=>{x.closest(".mermaid-container")||i(x,t)})},t?50:0)})};return{initMermaid:m,rerenderMermaid:()=>{m(!0)}}};var Be=le();const Le=P(Be),Me=e=>{const o=new WeakMap,r=()=>{const n=document.documentElement.classList.contains("dark");return{textColor:n?"#e0e0e0":"#000000",lineColor:n?"#e0e0e0":"#000000",fillColor:n?"#2a2a2a":"#ffffff",isDark:n}},u=()=>{const{textColor:n,lineColor:t,fillColor:c,isDark:p}=r();return{"line-width":2,"line-length":50,"text-margin":10,"font-size":14,"font-color":n,"line-color":t,"element-color":n,fill:c,"yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,flowstate:{past:{fill:p?"#444444":"#CCCCCC","font-size":12},current:{fill:p?"#4a4a00":"yellow","font-color":p?"#ff6b6b":"red","font-weight":"bold"},future:{fill:p?"#666600":"#FFFF99"},request:{fill:p?"#003366":"blue"},invalid:{fill:p?"#222222":"#444444"},approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}}},f=n=>{const t=document.createElement("div");return t.className="flowchart-svg-container",t.id=n+"-svg",t},s=(n,t=!1)=>{const c=n.id||"flowchart-"+Math.random().toString(36).substr(2,9),p=n.parentElement?.classList.contains("flowchart-container")?n.parentElement:null;let l="";if(l=n.textContent||"",!l.trim()&&t&&p&&o.has(p)&&(l=o.get(p)||""),l.trim()&&p&&!o.has(p)&&o.set(p,l),!!l.trim()&&!(n.classList.contains("flowchart-rendered")&&!t)){n.classList.add("flowchart-rendered");try{const g=Le.parse(l),h=f(c),y=n.parentElement;if(y&&y.classList.contains("flowchart-container")){y.innerHTML="",y.appendChild(h);const k=u();g.drawSVG(c+"-svg",k)}}catch(g){console.error("Flowchart 渲染失败:",g),i(n,l)}}},i=(n,t)=>{const c=n.parentElement;c&&c.classList.contains("flowchart-container")&&(c.innerHTML='<pre class="flowchart-error">'+E(t)+"</pre>")},C=(n=!1)=>{q(()=>{if(!e.value)return;const c=e.value.querySelectorAll(".flowchart-container");n&&c.forEach(l=>{if(l.querySelector(".flowchart-svg-container")&&o.has(l)){const h=o.get(l)||"",y="flowchart-"+Math.random().toString(36).substr(2,9);h&&(l.innerHTML=`<pre class="flowchart" id="${y}">${h}</pre>`)}}),setTimeout(()=>{if(!e.value)return;e.value.querySelectorAll(".flowchart-container").forEach(h=>{const y=h.querySelector("pre.flowchart");y&&s(y,n)})},n?50:0)})};return{initFlowchart:C,rerenderFlowchart:()=>{C(!0)}}},Ae={class:"article-card detail-card"},De={key:0,class:"badge"},Fe={class:"card-body"},Ie={class:"tag-row"},qe={class:"tag"},Pe={class:"title"},He={class:"description"},Ne={class:"meta"},Oe={class:"nav-row"},Ve=["disabled"],ze=["disabled"],je=["innerHTML"],Ge=B({__name:"ArticleContent",props:{article:{},htmlContent:{},prevArticle:{},nextArticle:{}},emits:["goPrev","goNext"],setup(e,{emit:o}){const{t:r}=L(),u=W(),f=e,s=o,i=G(),{addCopyButtons:C}=Ee(i,g=>({copy:r("code.copy"),copied:r("code.copied"),copyFailed:r("code.copyFailed"),copyCode:r("code.copyCode")})[g]||g),{initMermaid:m,rerenderMermaid:n}=$e(i),{initFlowchart:t,rerenderFlowchart:c}=Me(i),p=()=>{C(),m(),t(),l()},l=()=>{q(()=>{if(!i.value)return;const g=i.value.querySelectorAll("table"),h=u.isDark||document.documentElement.classList.contains("dark"),k=getComputedStyle(document.documentElement).getPropertyValue("--border").trim()||"#e5e7eb",S=h?"#d1d5db":k;g.forEach(w=>{w.style.setProperty("border",`2px solid ${S}`,"important"),w.querySelectorAll("th, td").forEach(X=>{X.style.setProperty("border",`1px solid ${S}`,"important")})})})};return J(()=>{p(),new MutationObserver(()=>{l(),setTimeout(()=>{n(),c()},100)}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),setTimeout(()=>{l()},100)}),H(()=>f.htmlContent,()=>{p(),setTimeout(()=>{l()},100)}),H(()=>u.isDark,()=>{setTimeout(()=>{l(),n(),c()},100)}),(g,h)=>(_(),b("article",Ae,[a("div",{class:"card-cover",style:K(v(ie)(e.article.cover))},[e.article.badge?(_(),b("span",De,d(e.article.badge),1)):$("",!0)],4),a("div",Fe,[a("div",Ie,[a("span",qe,d(e.article.tag),1)]),a("h2",Pe,d(e.article.title),1),a("p",He,d(e.article.description),1),a("div",Ne,[a("span",null,d(v(r)("article.created"))+": "+d(e.article.date),1),e.article.updatedDate?(_(),b(I,{key:0},[h[2]||(h[2]=a("span",{class:"dot"},"·",-1)),a("span",null,d(v(r)("article.updated"))+": "+d(e.article.updatedDate),1)],64)):$("",!0),h[3]||(h[3]=a("span",{class:"dot"},"·",-1)),a("span",null,d(e.article.platform),1),h[4]||(h[4]=a("span",{class:"dot"},"·",-1)),a("span",null,d(e.article.tag),1)]),a("div",Oe,[a("button",{class:"ghost-btn",type:"button",disabled:!e.prevArticle,onClick:h[0]||(h[0]=y=>s("goPrev"))}," ← "+d(v(r)("article.prevArticle")),9,Ve),a("button",{class:"ghost-btn",type:"button",disabled:!e.nextArticle,onClick:h[1]||(h[1]=y=>s("goNext"))},d(v(r)("article.nextArticle"))+" → ",9,ze)]),a("div",{ref_key:"contentBlockRef",ref:i,class:"content-block",innerHTML:e.htmlContent},null,8,je)])]))}}),Je=M(Ge,[["__scopeId","data-v-b88dd746"]]),Ke={key:0,class:"toc"},Ue={class:"toc-title"},We=["href","onClick"],Ye=B({__name:"ArticleTOC",props:{toc:{}},setup(e){const{t:o}=L(),r=(u,f)=>{u.preventDefault();const s=document.getElementById(f);if(s){const m=s.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:m,behavior:"smooth"}),history.replaceState(null,"",`#${f}`)}};return(u,f)=>e.toc.length?(_(),b("aside",Ke,[a("div",Ue,d(v(o)("toc.title")),1),a("nav",null,[(_(!0),b(I,null,U(e.toc,s=>(_(),b("a",{key:s.id,class:"toc-item",style:K({paddingLeft:`${(s.level-1)*12}px`}),href:`#${s.id}`,onClick:i=>r(i,s.id)},d(s.text),13,We))),128))])])):$("",!0)}}),Qe=M(Ye,[["__scopeId","data-v-298d8e57"]]),Xe={class:"comments"},Ze={class:"comments__header"},Re={class:"comments__count"},et={key:0,class:"comments__list"},tt={class:"comment__header"},ot={class:"comment__author"},rt={class:"comment__time"},nt={class:"comment__content"},at={key:1,class:"comments__empty"},st={class:"form-row"},ct=["placeholder"],lt={class:"form-row"},it=["placeholder"],dt={class:"submit-btn",type:"submit"},ut=B({__name:"CommentSection",props:{comments:{},articleId:{}},emits:["submit"],setup(e,{emit:o}){const{t:r}=L(),u=o,f=Z({author:"",content:""}),s=()=>{const i=f.content.trim();i&&(u("submit",{author:f.author,content:i}),f.author="",f.content="")};return(i,C)=>(_(),b("section",Xe,[a("header",Ze,[a("h3",null,d(v(r)("comments.title")),1),a("span",Re,d(v(r)("comments.count",{count:e.comments.length})),1)]),e.comments.length?(_(),b("ul",et,[(_(!0),b(I,null,U(e.comments,m=>(_(),b("li",{key:m.id,class:"comment"},[a("div",tt,[a("span",ot,d(m.author),1),a("span",rt,d(new Date(m.createdAt).toLocaleString()),1)]),a("p",nt,d(m.content),1)]))),128))])):(_(),b("p",at,d(v(r)("comments.empty")),1)),a("form",{class:"comment-form",onSubmit:R(s,["prevent"])},[a("div",st,[a("label",null,[N(d(v(r)("comments.authorLabel"))+" ",1),O(a("input",{"onUpdate:modelValue":C[0]||(C[0]=m=>f.author=m),placeholder:v(r)("comments.authorPlaceholder")},null,8,ct),[[V,f.author]])])]),a("div",lt,[a("label",null,[N(d(v(r)("comments.contentLabel"))+" ",1),O(a("textarea",{"onUpdate:modelValue":C[1]||(C[1]=m=>f.content=m),rows:"4",required:"",placeholder:v(r)("comments.contentPlaceholder")},null,8,it),[[V,f.content]])])]),a("button",dt,d(v(r)("comments.submit")),1)],32)]))}}),mt=M(ut,[["__scopeId","data-v-a9391980"]]),pt={class:"layout detail-layout"},ht={class:"article-area"},ft={class:"content-wrapper"},gt={key:1,class:"article-card detail-card empty-state"},vt={class:"card-body"},Ct={class:"title"},yt={class:"description"},bt=B({__name:"ArticleDetailPage",setup(e){const o=ee(),r=oe(),{t:u}=L(),f=W(),{loadComments:s,getComments:i,addComment:C}=ve(),m=T(()=>{const w=o.params.id;return w?re(w)??null:null}),n=T(()=>m.value?.content??""),t=ge(n),c=T(()=>m.value?F.findIndex(w=>w.id===m.value?.id):-1),p=T(()=>c.value>0?F[c.value-1]:null),l=T(()=>c.value>=0&&c.value<F.length-1?F[c.value+1]:null),g=T(()=>{const w=m.value?.id;return w?i(w):[]}),h=()=>{r.back()},y=()=>{p.value&&r.push({name:"articleDetail",params:{id:p.value.id}})},k=()=>{l.value&&r.push({name:"articleDetail",params:{id:l.value.id}})},x=()=>{m.value&&r.push({name:"articleEdit",params:{id:m.value.id}})},S=w=>{m.value&&C(m.value.id,w)};return J(()=>{s()}),(w,Q)=>(_(),b("main",pt,[D(Te,{article:m.value,onGoBack:h,onEdit:x},null,8,["article"]),a("section",ht,[m.value?(_(),b("div",{key:0,class:te(["detail-grid",`layout-${v(f).articleLayout}`])},[a("div",ft,[D(Je,{article:m.value,"html-content":v(t).html,"prev-article":p.value??null,"next-article":l.value??null,onGoPrev:y,onGoNext:k},null,8,["article","html-content","prev-article","next-article"]),D(mt,{comments:g.value,"article-id":m.value.id,onSubmit:S},null,8,["comments","article-id"])]),D(Qe,{toc:v(t).toc},null,8,["toc"])],2)):(_(),b("article",gt,[a("div",vt,[a("h2",Ct,d(v(u)("article.notFound")),1),a("p",yt,d(v(u)("article.notFoundDesc")),1)])]))])]))}}),Bt=M(bt,[["__scopeId","data-v-71d90ab1"]]);export{Bt as default};
