import{r as D,c as P,d as E,u as j,a as l,b as e,j as b,t as r,g as S,e as u,F as C,h as M,i,w as H,k as Z,l as G,v as ee,m as te,p as K,q as se,s as F,f as Y}from"./vue-vendor-D3XWct0c.js";import{a as R}from"./index-DNTZjpN0.js";import{u as ae}from"./useCategories-BYgl4rKb.js";import{g as B}from"./coverStyle-BhxAb7xK.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./math-vendor-D7u2X9zi.js";import"./markdown-vendor-BDlm1NQN.js";const ne=p=>{const g=D(""),w=(m,c)=>{if(!c.trim())return m;const $=new RegExp(`(${c})`,"gi");return m.replace($,"<mark>$1</mark>")},y=P(()=>{const m=g.value.trim().toLowerCase();return m?p.filter(c=>[c.title,c.description,c.content,c.tag,c.categoryKey].join(" ").toLowerCase().includes(m)):p}),v=P(()=>{const m=g.value.trim();return m?y.value.map(c=>({...c,highlightedTitle:w(c.title,m),highlightedDescription:w(c.description,m)})):[]});return{searchQuery:g,searchResults:y,highlightedResults:v,clearSearch:()=>{g.value=""}}},oe={class:"pagination"},le={class:"pagination-controls"},ie={key:0,class:"total-items"},re={key:1,class:"pagination-buttons"},ce=["disabled"],de={class:"page-numbers"},ue=["disabled","onClick"],ge=["disabled"],he={class:"items-per-page"},pe=["value"],ve=["value"],me=E({__name:"Pagination",props:{currentPage:{default:1},totalPages:{default:1},totalItems:{default:0},itemsPerPage:{default:5},itemsPerPageOptions:{default:()=>[5,10,20,50]}},emits:["update:currentPage","update:itemsPerPage","page-change"],setup(p,{emit:g}){const{t:w}=j(),y=p,v=g,V=P(()=>{const a=[],_=y.totalPages,h=y.currentPage;if(_<=7)for(let d=1;d<=_;d++)a.push(d);else if(h<=3){for(let d=1;d<=4;d++)a.push(d);a.push("..."),a.push(_)}else if(h>=_-2){a.push(1),a.push("...");for(let d=_-3;d<=_;d++)a.push(d)}else{a.push(1),a.push("...");for(let d=h-1;d<=h+1;d++)a.push(d);a.push("..."),a.push(_)}return a}),m=a=>{typeof a=="number"&&a>=1&&a<=y.totalPages&&(v("update:currentPage",a),v("page-change",a),window.scrollTo({top:0,behavior:"smooth"}))},c=()=>{if(y.currentPage>1){const a=y.currentPage-1;v("update:currentPage",a),v("page-change",a),window.scrollTo({top:0,behavior:"smooth"})}},$=()=>{if(y.currentPage<y.totalPages){const a=y.currentPage+1;v("update:currentPage",a),v("page-change",a),window.scrollTo({top:0,behavior:"smooth"})}},N=a=>{const _=a.target,h=parseInt(_.value,10);v("update:itemsPerPage",h),v("update:currentPage",1),v("page-change",1),window.scrollTo({top:0,behavior:"smooth"})};return(a,_)=>(i(),l("div",oe,[e("div",le,[p.totalItems>0?(i(),l("div",ie," å…± "+r(p.totalItems)+" æ¡ ",1)):b("",!0),p.totalPages>1?(i(),l("div",re,[e("button",{class:S(["page-btn",{disabled:p.currentPage===1}]),disabled:p.currentPage===1,onClick:c},r(u(w)("pagination.prev")),11,ce),e("div",de,[(i(!0),l(C,null,M(V.value,h=>(i(),l("button",{key:h,class:S(["page-number",{active:h===p.currentPage,ellipsis:h==="..."}]),disabled:h==="...",onClick:d=>m(h)},r(h),11,ue))),128))]),e("button",{class:S(["page-btn",{disabled:p.currentPage===p.totalPages}]),disabled:p.currentPage===p.totalPages,onClick:$},r(u(w)("pagination.next")),11,ge)])):b("",!0),e("div",he,[e("select",{value:p.itemsPerPage,class:"items-per-page-select",onChange:N},[(i(!0),l(C,null,M(p.itemsPerPageOptions,h=>(i(),l("option",{key:h,value:h},r(h)+" / page ",9,ve))),128))],40,pe)])])]))}}),_e=q(me,[["__scopeId","data-v-6c653ad1"]]),ye={class:"layout"},be={class:"content"},fe={class:"sidebar"},Pe={class:"filter-title"},ke={class:"category-list"},we=["onClick"],Ce={class:"category-label"},Te={class:"category-count"},$e={class:"article-area"},De={class:"search-section"},Me={class:"search-box"},xe=["placeholder"],Se={class:"list-header"},Ve={class:"article-count"},Ie={key:0,class:"search-hint"},Le={class:"header-actions"},Ne=["title"],Ae={key:0},Re={key:1},He={key:0,class:"articles"},Ke=["onClick","onKeyup"],Fe={key:0,class:"badge"},Ye={class:"card-body"},Be={class:"tag-row"},Ee={class:"tag"},je=["innerHTML"],qe=["innerHTML"],Oe={class:"meta"},Ue={key:0,class:"empty-state"},ze={key:1,class:"timeline-view"},Qe={class:"timeline-container"},Je={class:"timeline-year-node"},We={class:"year-circle"},Xe={class:"timeline-articles"},Ze=["onClick","onKeyup"],Ge={class:"timeline-content"},et={key:0,class:"timeline-badge"},tt={class:"timeline-info"},st={class:"timeline-date"},at={class:"updated-date"},nt=["innerHTML"],ot=["innerHTML"],lt={key:0,class:"empty-state"},it=E({__name:"ArticlesPage",setup(p){const{t:g}=j(),w=se(),{categories:y}=ae(!0),v=D("all"),V=P(()=>{const o={};return o.all=R.length,y.value.forEach(s=>{s.key!=="all"&&(o[s.key]=R.filter(t=>t.categoryKey===s.key).length)}),o}),m=D(!0),{searchQuery:c,searchResults:$,highlightedResults:N}=ne(R),a=D(5),_=D(1),d=D((()=>{try{const o=localStorage.getItem("articleViewMode");if(o==="list"||o==="timeline")return o}catch(o){console.warn("Failed to read view mode from localStorage:",o)}return"list"})()),I=o=>{w.push({name:"articleDetail",params:{id:o}})},O=()=>{w.push({name:"articleNew"})},x=P(()=>{let o=$.value;return v.value!=="all"&&(o=o.filter(s=>s.categoryKey===v.value)),o.slice().sort((s,t)=>{const n=new Date(s.date).getTime()-new Date(t.date).getTime();return m.value?-n:n})}),A=P(()=>{const o=c.value.trim();let s=x.value;return o&&(s=s.map(t=>{const n=N.value.find(k=>k.id===t.id);return n?{...t,highlightedTitle:n.highlightedTitle,highlightedDescription:n.highlightedDescription}:t})),s}),U=P(()=>{const o=(_.value-1)*a.value,s=o+a.value;return A.value.slice(o,s)}),z=P(()=>Math.ceil(A.value.length/a.value)),L=()=>{_.value=1};H([c,v,m],()=>{L()});const Q=()=>{m.value=!m.value,L()},J=()=>{d.value=d.value==="list"?"timeline":"list",L()};H(d,o=>{try{localStorage.setItem("articleViewMode",o)}catch(s){console.warn("Failed to save view mode to localStorage:",s)}});const W=P(()=>{const o={};return x.value.forEach(t=>{const n=new Date(t.date).getFullYear().toString();o[n]||(o[n]=[]),o[n].push(t)}),Object.keys(o).sort((t,n)=>Number(n)-Number(t)).map(t=>({year:t,articles:o[t]}))}),X=P(()=>{const o=W.value.flatMap(f=>(f.articles||[]).map(T=>({...T,year:f.year}))),s=(_.value-1)*a.value,t=s+a.value,n=o.slice(s,t),k={};return n.forEach(f=>{const T=f.year;k[T]||(k[T]=[]),k[T].push(f)}),Object.keys(k).sort((f,T)=>Number(T)-Number(f)).map(f=>({year:f,articles:k[f]||[]}))});return(o,s)=>(i(),l("main",ye,[e("section",be,[e("aside",fe,[e("div",Pe,[s[4]||(s[4]=e("span",{class:"filter-icon"},"âŒ˜",-1)),e("span",null,r(u(g)("filter.category")),1)]),e("div",ke,[(i(!0),l(C,null,M(u(y),t=>(i(),l("button",{key:t.key,class:S(["category-item",{active:v.value===t.key}]),type:"button",onClick:n=>{v.value=t.key,L()}},[e("span",Ce,r(t.label),1),e("span",Te,"("+r(V.value[t.key]||0)+")",1)],10,we))),128))])]),e("section",$e,[e("div",De,[e("div",Me,[s[5]||(s[5]=e("span",{class:"search-icon"},"ðŸ”",-1)),G(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>te(c)?c.value=t:null),type:"text",class:"search-input",placeholder:u(g)("search.placeholder")},null,8,xe),[[ee,u(c)]]),u(c)?(i(),l("button",{key:0,class:"clear-btn",type:"button",onClick:s[1]||(s[1]=t=>c.value="")}," Ã— ")):b("",!0)])]),e("div",Se,[e("div",Ve,[K(r(u(g)("articles.count",{count:x.value.length}))+" ",1),u(c)?(i(),l("span",Ie,r(u(g)("search.results",{query:u(c)})),1)):b("",!0)]),e("div",Le,[e("button",{class:"view-toggle-btn",type:"button",onClick:J,title:d.value==="list"?u(g)("actions.timelineView"):u(g)("actions.listView")},[d.value==="list"?(i(),l("span",Ae,"ðŸ“…")):(i(),l("span",Re,"ðŸ“‹"))],8,Ne),e("button",{class:"new-article-btn",type:"button",onClick:O}," + "+r(u(g)("article.new")),1),e("button",{class:"sort-btn",type:"button",onClick:Q},[K(r(u(g)("actions.sortByTime"))+" ",1),e("span",{class:S(["arrow",{rotated:!m.value}])},"âŒ„",2)])])]),d.value==="list"?(i(),l("div",He,[(i(!0),l(C,null,M(U.value,t=>(i(),l("article",{key:t.id,class:"article-card",role:"button",tabindex:"0",onClick:n=>I(t.id),onKeyup:F(n=>I(t.id),["enter"])},[e("div",{class:"card-cover",style:Y(u(B)(t.cover))},[t.badge?(i(),l("span",Fe,r(t.badge),1)):b("",!0)],4),e("div",Ye,[e("div",Be,[e("span",Ee,r(t.tag),1)]),e("span",{class:"title",innerHTML:t.highlightedTitle||t.title},null,8,je),e("p",{class:"description",innerHTML:t.highlightedDescription||t.description},null,8,qe),e("div",Oe,[e("span",null,r(u(g)("article.created"))+": "+r(t.date),1),t.updatedDate?(i(),l(C,{key:0},[s[6]||(s[6]=e("span",{class:"dot"},"Â·",-1)),e("span",null,r(u(g)("article.updated"))+": "+r(t.updatedDate),1)],64)):b("",!0),s[7]||(s[7]=e("span",{class:"dot"},"Â·",-1)),e("span",null,r(t.platform),1)])])],40,Ke))),128)),x.value.length===0?(i(),l("div",Ue,[e("p",null,r(u(g)("search.noResults")),1)])):b("",!0)])):(i(),l("div",ze,[e("div",Qe,[s[11]||(s[11]=e("div",{class:"timeline-line"},null,-1)),(i(!0),l(C,null,M(X.value,t=>(i(),l("div",{key:t.year,class:"timeline-year-group"},[e("div",Je,[e("div",We,r(t.year),1)]),e("div",Xe,[(i(!0),l(C,null,M(t.articles,n=>(i(),l("article",{key:n.id,class:"timeline-article",role:"button",tabindex:"0",onClick:k=>I(n.id),onKeyup:F(k=>I(n.id),["enter"])},[s[10]||(s[10]=e("div",{class:"timeline-dot"},null,-1)),e("div",Ge,[e("div",{class:"timeline-thumbnail",style:Y(u(B)(n.cover))},[n.badge?(i(),l("span",et,r(n.badge),1)):b("",!0)],4),e("div",tt,[e("div",st,[s[9]||(s[9]=e("span",{class:"date-icon"},"ðŸ“…",-1)),e("span",null,r(n.date),1),n.updatedDate&&n.updatedDate!==n.date?(i(),l(C,{key:0},[s[8]||(s[8]=e("span",{class:"date-separator"},"Â·",-1)),e("span",at,r(u(g)("article.updated"))+": "+r(n.updatedDate),1)],64)):b("",!0)]),e("h3",{class:"timeline-title",innerHTML:n.highlightedTitle||n.title},null,8,nt),n.description?(i(),l("p",{key:0,class:"timeline-description",innerHTML:n.highlightedDescription||n.description},null,8,ot)):b("",!0)])])],40,Ze))),128))])]))),128))]),x.value.length===0?(i(),l("div",lt,[e("p",null,r(u(g)("search.noResults")),1)])):b("",!0)])),Z(_e,{"current-page":_.value,"onUpdate:currentPage":s[2]||(s[2]=t=>_.value=t),"items-per-page":a.value,"onUpdate:itemsPerPage":s[3]||(s[3]=t=>a.value=t),"total-pages":z.value,"total-items":A.value.length,"items-per-page-options":[5,10,20,50]},null,8,["current-page","items-per-page","total-pages","total-items"])])])]))}}),mt=q(it,[["__scopeId","data-v-b7082a05"]]);export{mt as default};
